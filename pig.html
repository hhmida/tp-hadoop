<!doctype html><html lang=fr class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Atelier Hadoop - HDFS - MapReduce - Pig - Hive"><meta name=author content="Hmida Hmida"><link rel=canonical href=https://hhmida.github.io/tp-hadoop/pig.html><link rel=prev href=mrjava.html><link rel=next href=hive.html><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.9"><title>Pig - Débuter avec l'écosystème Hadoop</title><link rel=stylesheet href=assets/stylesheets/main.f2e4d321.min.css><link rel=stylesheet href=assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=assets/stylesheets/extra.css><script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-QJTFFQBDR6"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-QJTFFQBDR6",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-QJTFFQBDR6",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#pig class=md-skip> Aller au contenu </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=En-tête> <a href=index.html title="Débuter avec l'écosystème Hadoop" class="md-header__button md-logo" aria-label="Débuter avec l'écosystème Hadoop" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12.098 3.01c-1.133.277-1.466.474-1.842 1.787.478-.962.84-1.315 1.842-1.787zm3.228.076c-.834-.053-1.715.177-2.756.615a3.97 3.97 0 0 0-1.199.76c-.31.287-.576.62-.866 1.006a1.312 1.312 0 0 0-.468.095 1.868 1.868 0 0 0-.539.356c-.141.124-.28.252-.416.383v.002c-.123.12-.244.241-.363.365-.945.152-1.72.32-2.41.588a6.314 6.314 0 0 0-1.97 1.217 5.205 5.205 0 0 0-.687.736 5.435 5.435 0 0 0-.503.803c-.13.142-.26.288-.399.414a1.45 1.45 0 0 1-.441.285c-.093.035-.133.058-.137.056-.004-.001-.008-.033-.012-.047.235-.21.267-.55.289-.86.03.034.053.068.082.113.031.047.062.095.1.142l.158.2.055-.249c.046-.208.081-.484.027-.724-.034-.153-.117-.315-.235-.393l.036-.09c.04-.1.08-.204.115-.303l.069-.193-.204.035c-.27.047-.852.366-1.261.791-.152.158-.284.33-.37.514a.984.984 0 0 0-.093.59.91.91 0 0 0 .272.498c.03.12.058.223.087.316.033.104.068.198.112.29.119.247.31.398.529.468.182.059.369.066.566.02a3.83 3.83 0 0 0-.072.69 8.911 8.911 0 0 0 .07 1.394c.013.093.028.184.045.275l-.107.291-.166.455-.37.365-.343.34a9.22 9.22 0 0 1-.082.08c-.232.224-.279.27-.213.662.04.241.119.484.242.72.114.216.267.427.463.624.245.245.647.55 1.066.71.245.092.488.138.723.097l-.039.11a4.046 4.046 0 0 1-.123.3c-.285.624.008.95.463 1.158.227.104.497.173.748.238l.168.045c.298.08.812.228 1.281.258.513.033.974-.073 1.098-.533.049-.182.078-.322.09-.459a2.33 2.33 0 0 0-.01-.406c.144-.32.21-.423.316-.578l.053-.08c.115-.17.168-.29.188-.426.018-.131.004-.262-.02-.461l-.011-.084a6.822 6.822 0 0 0 1.338.05l-.118.061-.055.03c-.395.203-.413.587-.289.984.112.357.343.723.487.945.303.467.592.861.943 1.076.368.226.786.253 1.328-.04.276-.15.363-.302.48-.507.038-.066.08-.133.126-.204.101-.05.382-.296.67-.534l.296-.242c.073.053.164.09.27.115.14.034.305.05.504.065.149.01.635.01.949.01h.227c.324.001.585-.016.783-.128.21-.119.334-.331.361-.71a1.28 1.28 0 0 0-.008-.378.946.946 0 0 0-.136-.312l-.014-.502-.016-.521a2.372 2.372 0 0 0-.068-.536 3.558 3.558 0 0 0-.18-.505c-.053-.127-.096-.245-.138-.36a5.756 5.756 0 0 0-.229-.547l.018-.123.181.174.266.258c.203.196.39.373.607.502.226.133.479.21.807.195a1.925 1.925 0 0 0 1.016-.385c.293-.216.528-.509.627-.832l.084-.279.07-.225c.482.082.998.11 1.498.057a3.7 3.7 0 0 0 1.351-.389 3.406 3.406 0 0 0 1.35-1.33h.002v-.002c.355-.616.555-1.34.63-2.088.062-.599.028-1.415-.097-2.2-.11-.701-.295-1.38-.55-1.87a.736.736 0 0 0-.137-.178 1.413 1.413 0 0 0-.51-.31c-.206-.07-.422-.084-.594.006a.485.485 0 0 0-.123.09 2.793 2.793 0 0 0-.3.388c-.106.153-.21.307-.337.414-.149.128-.327.202-.502.272a3.454 3.454 0 0 0-.261-.508 4.81 4.81 0 0 0-.399-.54 2.21 2.21 0 0 0-.365-.349 5.357 5.357 0 0 0-.41-.275c-.407-.255-.754-.559-1.108-.87-.16-.14-.323-.282-.482-.413-.842-.695-1.628-1.031-2.469-1.084zm-4.129.004c-.57.137-.68.245-.851.804.273-.41.43-.545.851-.804zm3.952.465c.829-.001 1.587.303 2.431 1.013.412.347.774.684 1.192.983-.152.013-.283.04-.455.107.21-.04.451 0 .67.04.06.039.124.078.189.116.295.174.463.27.662.547.21.294.386.589.541.912-.101-.036-.186-.067-.262-.09a.566.566 0 0 0-.533.034l-.012.006c-.163.079-.416.17-.586.197a.7.7 0 0 0 .405-.006.565.565 0 0 0-.018.539.269.269 0 0 1-.02-.12.228.228 0 0 1 .249-.208.233.233 0 0 1 .187.33c-.117.02-.233.055-.353.1a4.41 4.41 0 0 0-.237.095 3.722 3.722 0 0 1 1.084-.02c.025.117.05.24.073.366l-.137.01-.012.002c-.174-.14-.367-.117-.633-.057-.806.184-.617.637-.988 1.318.385-.47.357-.962.984-1.11.147-.036.247-.078.346-.063-.178.09-.333.237-.394.41-.173.486-.065.895-.254 1.35.234-.407.249-.802.459-1.23.075-.153.354-.4.525-.403l.14-.002c.042.27.068.539.052.761a8.535 8.535 0 0 1-.198 1.24c.213-.272.31-.85.403-1.257.097-.424.07-.934-.014-1.389-.117-.625.527-.522.9-.816.275-.217.463-.564.715-.809.25-.243.644.114.742.352.426 1.03.62 2.65.508 3.69-.126 1.164-.69 2.437-1.719 3.01-1.31.732-2.854.285-4.156-.154-.278-.093-.47-.229-.715-.382.067.3.097.615.008.914-.14.474-.367 1.251.277 1.394.246.055.357.048.704-.13a1.3 1.3 0 0 1-.616.011.397.397 0 0 1-.314-.273c.06.044.16.066.33.107.478.115.932-.114 1.021-.445.052-.194.043-.295.153-.559.099.03.202.059.306.084l-.177.578c-.154.501-.752.904-1.28.895-.488-.009-.797-.314-1.134-.613l-.678-.6a5.228 5.228 0 0 1-1.658-.834c.4.472.673.732 1.232.967-.081.83-.37 1.436-.615 2.23-.111.36-.991 1.8-1.234 1.94-.174.1-1.26 1.016-1.465 1.136-.153.203-.287.483-.516.604-.698.37-1.148-.339-1.523-.936-.171-.272-.645-1.054-.23-1.273.39-.208.61-.357 1.009-.62.059.108.159.212.225.32l-.043-.352a2.752 2.752 0 0 1-.008-.596c.016-.206.03-.413.047-.62-.06.21-.179.42-.239.63-.024.084-.045.152-.056.214a7.05 7.05 0 0 1-2.682.034 16.76 16.76 0 0 0-.185-.926c-.018.278-.007 1.047-.008 1.476-.001.333-.016.448-.188.731-.16.265-.228.325-.453.773.019.283.019.47-.057.739-.125.446-1.386.098-1.718.007-.41-.112-1.256-.278-1.043-.824.187-.48.307-.986.398-1.658-.75-1.08-1.448-2.56-1.582-3.873-.104-1.019-.04-1.646.18-2.27.35-.987.837-1.843 1.62-2.53 1.06-.929 2.049-1.303 3.598-1.539-.373.417-.741.858-1.143 1.33-.406.479-.648.963-.906 1.487-.357.722-.348.996.125 1.63.407.547.627.794.804 1.328-.146.303-.2.56-.25.973.5.545.87.918 1.354 1.033.475.113.872.093 1.297-.125.944-.482 1.816-1.107 2.88-1.132.493-1.211.444-2.222.208-3.393-.162-.8-.227-1.557-.278-2.373-.2.84-.236 1.577-.088 2.414.18 1.008.318 2.124-.18 3.01-.962.073-1.788.658-2.655 1.107-.35.18-.712.198-1.098.092-.358-.098-.6-.334-.986-.78-.006-.446.095-.653.3-1.058.33-.65.695-1.255 1.094-1.894-.49.59-.953 1.084-1.338 1.677-.147-.419-.358-.633-.707-1.105-.34-.461-.375-.662-.12-1.196.255-.536.472-1.008.907-1.478.753-.813 1.443-1.717 2.266-2.518.447-.434.628-.42 1.22-.51a20.768 20.768 0 0 0 1.606-.31 22.5 22.5 0 0 1-1.553.08h-.015c.506-.646.799-1.006 1.62-1.363.95-.412 1.738-.652 2.47-.652zm.556 2.79c-1.101.276-1.307.739-1.166 1.45.121-.535.335-1.05 1.166-1.45zm-3.263.061c-.446.05-.89.096-1.336.139-.375.035-.436.03-.702.293-.403.399-.794 1.768-.92 2.316.198-.455.69-1.729 1.069-2.053.105-.09.18-.143.258-.183-.271.455-.252.566-.157 1.176.081-.62.295-.859.647-1.32a9.287 9.287 0 0 0 1.14-.368zm10.226.053c-.255.517-.65.95-1.185 1.215-.288.142-.47.093-.791.062.326.094.533.21.853.096.652-.233.967-.756 1.123-1.373zm-2.28.834c.023.047.046.096.067.144a.602.602 0 0 0-.05.041.572.572 0 0 0-.126-.181l.11-.004zm-3.26.4c-.36.166-.779.126-1.087.334-.271.184-.646.764-.922 1.01.2-.078.394-.212.57-.354.002.22.101.426.27.565a.31.31 0 0 1 .092-.492.312.312 0 0 1 .432.191c-.148.11-.284.238-.397.387a1.666 1.666 0 0 0-.24.44 4.222 4.222 0 0 1 2.002-1.294c-.2-.003-.437.034-.678.114a.732.732 0 0 0-.482-.614c.16-.085.316-.175.44-.287zm-1.042 1.64a.735.735 0 0 1-.125-.083.35.35 0 0 0 .125.084zM1.32 8.34c-.953.672-1.19.978-1.062 2.338C.352 9.608.56 9.145 1.32 8.34zm-.808.404c-.482.336-.545.475-.5 1.059.105-.482.203-.664.5-1.059zm1.779.195c-.07.15-.118.264-.152.381-.147.508.066.962-.395 1.33.217.438.207.612.711.41.195-.078.355-.187.498-.316-.07.18-.133.361-.191.545l-.03.094c-.36.153-.834.25-1.015-.13a3.458 3.458 0 0 1-.203-.595c-.594-.615.294-1.427.777-1.719zm.123.276c.123.071.156.2.17.375-.073-.074-.132-.122-.227-.112a1.495 1.495 0 0 1 .057-.263zm14.87 3.267c-.131.022-.365.07-.495.092-.348.059-.387.142-.441.484l-.086.524a9.16 9.16 0 0 1 .228-.568c.084-.184.132-.202.31-.3.127-.068.357-.163.483-.232zm-14.47 2.4c.274.946.738 1.876 1.255 2.657v.014a.993.993 0 0 1-.149.369c-.369.493-1.306-.23-1.578-.508-.297-.303-.496-.662-.543-.998-.034-.246-.001-.252.17-.426l.693-.701.153-.406zm12.405.62c.056.183.101.364.183.558.138.326.205.526.215.875l.032 1.106c.117.206.136.249.115.484-.043.481-.203.513-.625.506-.192-.003-.957-.007-1.15-.023-.274-.024-.429-.05-.512-.112.43-.316 1.162-1.619 1.304-2.068.151-.474.315-.888.438-1.326z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Débuter avec l'écosystème Hadoop </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Pig </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=red aria-label="Basculer au mode sombre" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Basculer au mode sombre" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=red aria-label="Basculer au mode clair" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Basculer au mode clair" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Rechercher placeholder=Rechercher autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Recherche> <button type=reset class="md-search__icon md-icon" title=Effacer aria-label=Effacer tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initialisation de la recherche </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Onglets data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=index.html class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=environnement.html class=md-tabs__link> Préparation de l'environnement </a> </li> <li class=md-tabs__item> <a href=hdfs.html class=md-tabs__link> Manipulation de HDFS </a> </li> <li class=md-tabs__item> <a href=mr.html class=md-tabs__link> MapReduce en Python </a> </li> <li class=md-tabs__item> <a href=mrjava.html class=md-tabs__link> MapReduce en Java </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=pig.html class=md-tabs__link> Pig </a> </li> <li class=md-tabs__item> <a href=hive.html class=md-tabs__link> Hive </a> </li> <li class=md-tabs__item> <a href=ucase.html class=md-tabs__link> Cas Pratique </a> </li> <li class=md-tabs__item> <a href=cluster.html class=md-tabs__link> Hadoop en mode cluster </a> </li> <li class=md-tabs__item> <a href=solutions.html class=md-tabs__link> Solutions </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=index.html title="Débuter avec l'écosystème Hadoop" class="md-nav__button md-logo" aria-label="Débuter avec l'écosystème Hadoop" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12.098 3.01c-1.133.277-1.466.474-1.842 1.787.478-.962.84-1.315 1.842-1.787zm3.228.076c-.834-.053-1.715.177-2.756.615a3.97 3.97 0 0 0-1.199.76c-.31.287-.576.62-.866 1.006a1.312 1.312 0 0 0-.468.095 1.868 1.868 0 0 0-.539.356c-.141.124-.28.252-.416.383v.002c-.123.12-.244.241-.363.365-.945.152-1.72.32-2.41.588a6.314 6.314 0 0 0-1.97 1.217 5.205 5.205 0 0 0-.687.736 5.435 5.435 0 0 0-.503.803c-.13.142-.26.288-.399.414a1.45 1.45 0 0 1-.441.285c-.093.035-.133.058-.137.056-.004-.001-.008-.033-.012-.047.235-.21.267-.55.289-.86.03.034.053.068.082.113.031.047.062.095.1.142l.158.2.055-.249c.046-.208.081-.484.027-.724-.034-.153-.117-.315-.235-.393l.036-.09c.04-.1.08-.204.115-.303l.069-.193-.204.035c-.27.047-.852.366-1.261.791-.152.158-.284.33-.37.514a.984.984 0 0 0-.093.59.91.91 0 0 0 .272.498c.03.12.058.223.087.316.033.104.068.198.112.29.119.247.31.398.529.468.182.059.369.066.566.02a3.83 3.83 0 0 0-.072.69 8.911 8.911 0 0 0 .07 1.394c.013.093.028.184.045.275l-.107.291-.166.455-.37.365-.343.34a9.22 9.22 0 0 1-.082.08c-.232.224-.279.27-.213.662.04.241.119.484.242.72.114.216.267.427.463.624.245.245.647.55 1.066.71.245.092.488.138.723.097l-.039.11a4.046 4.046 0 0 1-.123.3c-.285.624.008.95.463 1.158.227.104.497.173.748.238l.168.045c.298.08.812.228 1.281.258.513.033.974-.073 1.098-.533.049-.182.078-.322.09-.459a2.33 2.33 0 0 0-.01-.406c.144-.32.21-.423.316-.578l.053-.08c.115-.17.168-.29.188-.426.018-.131.004-.262-.02-.461l-.011-.084a6.822 6.822 0 0 0 1.338.05l-.118.061-.055.03c-.395.203-.413.587-.289.984.112.357.343.723.487.945.303.467.592.861.943 1.076.368.226.786.253 1.328-.04.276-.15.363-.302.48-.507.038-.066.08-.133.126-.204.101-.05.382-.296.67-.534l.296-.242c.073.053.164.09.27.115.14.034.305.05.504.065.149.01.635.01.949.01h.227c.324.001.585-.016.783-.128.21-.119.334-.331.361-.71a1.28 1.28 0 0 0-.008-.378.946.946 0 0 0-.136-.312l-.014-.502-.016-.521a2.372 2.372 0 0 0-.068-.536 3.558 3.558 0 0 0-.18-.505c-.053-.127-.096-.245-.138-.36a5.756 5.756 0 0 0-.229-.547l.018-.123.181.174.266.258c.203.196.39.373.607.502.226.133.479.21.807.195a1.925 1.925 0 0 0 1.016-.385c.293-.216.528-.509.627-.832l.084-.279.07-.225c.482.082.998.11 1.498.057a3.7 3.7 0 0 0 1.351-.389 3.406 3.406 0 0 0 1.35-1.33h.002v-.002c.355-.616.555-1.34.63-2.088.062-.599.028-1.415-.097-2.2-.11-.701-.295-1.38-.55-1.87a.736.736 0 0 0-.137-.178 1.413 1.413 0 0 0-.51-.31c-.206-.07-.422-.084-.594.006a.485.485 0 0 0-.123.09 2.793 2.793 0 0 0-.3.388c-.106.153-.21.307-.337.414-.149.128-.327.202-.502.272a3.454 3.454 0 0 0-.261-.508 4.81 4.81 0 0 0-.399-.54 2.21 2.21 0 0 0-.365-.349 5.357 5.357 0 0 0-.41-.275c-.407-.255-.754-.559-1.108-.87-.16-.14-.323-.282-.482-.413-.842-.695-1.628-1.031-2.469-1.084zm-4.129.004c-.57.137-.68.245-.851.804.273-.41.43-.545.851-.804zm3.952.465c.829-.001 1.587.303 2.431 1.013.412.347.774.684 1.192.983-.152.013-.283.04-.455.107.21-.04.451 0 .67.04.06.039.124.078.189.116.295.174.463.27.662.547.21.294.386.589.541.912-.101-.036-.186-.067-.262-.09a.566.566 0 0 0-.533.034l-.012.006c-.163.079-.416.17-.586.197a.7.7 0 0 0 .405-.006.565.565 0 0 0-.018.539.269.269 0 0 1-.02-.12.228.228 0 0 1 .249-.208.233.233 0 0 1 .187.33c-.117.02-.233.055-.353.1a4.41 4.41 0 0 0-.237.095 3.722 3.722 0 0 1 1.084-.02c.025.117.05.24.073.366l-.137.01-.012.002c-.174-.14-.367-.117-.633-.057-.806.184-.617.637-.988 1.318.385-.47.357-.962.984-1.11.147-.036.247-.078.346-.063-.178.09-.333.237-.394.41-.173.486-.065.895-.254 1.35.234-.407.249-.802.459-1.23.075-.153.354-.4.525-.403l.14-.002c.042.27.068.539.052.761a8.535 8.535 0 0 1-.198 1.24c.213-.272.31-.85.403-1.257.097-.424.07-.934-.014-1.389-.117-.625.527-.522.9-.816.275-.217.463-.564.715-.809.25-.243.644.114.742.352.426 1.03.62 2.65.508 3.69-.126 1.164-.69 2.437-1.719 3.01-1.31.732-2.854.285-4.156-.154-.278-.093-.47-.229-.715-.382.067.3.097.615.008.914-.14.474-.367 1.251.277 1.394.246.055.357.048.704-.13a1.3 1.3 0 0 1-.616.011.397.397 0 0 1-.314-.273c.06.044.16.066.33.107.478.115.932-.114 1.021-.445.052-.194.043-.295.153-.559.099.03.202.059.306.084l-.177.578c-.154.501-.752.904-1.28.895-.488-.009-.797-.314-1.134-.613l-.678-.6a5.228 5.228 0 0 1-1.658-.834c.4.472.673.732 1.232.967-.081.83-.37 1.436-.615 2.23-.111.36-.991 1.8-1.234 1.94-.174.1-1.26 1.016-1.465 1.136-.153.203-.287.483-.516.604-.698.37-1.148-.339-1.523-.936-.171-.272-.645-1.054-.23-1.273.39-.208.61-.357 1.009-.62.059.108.159.212.225.32l-.043-.352a2.752 2.752 0 0 1-.008-.596c.016-.206.03-.413.047-.62-.06.21-.179.42-.239.63-.024.084-.045.152-.056.214a7.05 7.05 0 0 1-2.682.034 16.76 16.76 0 0 0-.185-.926c-.018.278-.007 1.047-.008 1.476-.001.333-.016.448-.188.731-.16.265-.228.325-.453.773.019.283.019.47-.057.739-.125.446-1.386.098-1.718.007-.41-.112-1.256-.278-1.043-.824.187-.48.307-.986.398-1.658-.75-1.08-1.448-2.56-1.582-3.873-.104-1.019-.04-1.646.18-2.27.35-.987.837-1.843 1.62-2.53 1.06-.929 2.049-1.303 3.598-1.539-.373.417-.741.858-1.143 1.33-.406.479-.648.963-.906 1.487-.357.722-.348.996.125 1.63.407.547.627.794.804 1.328-.146.303-.2.56-.25.973.5.545.87.918 1.354 1.033.475.113.872.093 1.297-.125.944-.482 1.816-1.107 2.88-1.132.493-1.211.444-2.222.208-3.393-.162-.8-.227-1.557-.278-2.373-.2.84-.236 1.577-.088 2.414.18 1.008.318 2.124-.18 3.01-.962.073-1.788.658-2.655 1.107-.35.18-.712.198-1.098.092-.358-.098-.6-.334-.986-.78-.006-.446.095-.653.3-1.058.33-.65.695-1.255 1.094-1.894-.49.59-.953 1.084-1.338 1.677-.147-.419-.358-.633-.707-1.105-.34-.461-.375-.662-.12-1.196.255-.536.472-1.008.907-1.478.753-.813 1.443-1.717 2.266-2.518.447-.434.628-.42 1.22-.51a20.768 20.768 0 0 0 1.606-.31 22.5 22.5 0 0 1-1.553.08h-.015c.506-.646.799-1.006 1.62-1.363.95-.412 1.738-.652 2.47-.652zm.556 2.79c-1.101.276-1.307.739-1.166 1.45.121-.535.335-1.05 1.166-1.45zm-3.263.061c-.446.05-.89.096-1.336.139-.375.035-.436.03-.702.293-.403.399-.794 1.768-.92 2.316.198-.455.69-1.729 1.069-2.053.105-.09.18-.143.258-.183-.271.455-.252.566-.157 1.176.081-.62.295-.859.647-1.32a9.287 9.287 0 0 0 1.14-.368zm10.226.053c-.255.517-.65.95-1.185 1.215-.288.142-.47.093-.791.062.326.094.533.21.853.096.652-.233.967-.756 1.123-1.373zm-2.28.834c.023.047.046.096.067.144a.602.602 0 0 0-.05.041.572.572 0 0 0-.126-.181l.11-.004zm-3.26.4c-.36.166-.779.126-1.087.334-.271.184-.646.764-.922 1.01.2-.078.394-.212.57-.354.002.22.101.426.27.565a.31.31 0 0 1 .092-.492.312.312 0 0 1 .432.191c-.148.11-.284.238-.397.387a1.666 1.666 0 0 0-.24.44 4.222 4.222 0 0 1 2.002-1.294c-.2-.003-.437.034-.678.114a.732.732 0 0 0-.482-.614c.16-.085.316-.175.44-.287zm-1.042 1.64a.735.735 0 0 1-.125-.083.35.35 0 0 0 .125.084zM1.32 8.34c-.953.672-1.19.978-1.062 2.338C.352 9.608.56 9.145 1.32 8.34zm-.808.404c-.482.336-.545.475-.5 1.059.105-.482.203-.664.5-1.059zm1.779.195c-.07.15-.118.264-.152.381-.147.508.066.962-.395 1.33.217.438.207.612.711.41.195-.078.355-.187.498-.316-.07.18-.133.361-.191.545l-.03.094c-.36.153-.834.25-1.015-.13a3.458 3.458 0 0 1-.203-.595c-.594-.615.294-1.427.777-1.719zm.123.276c.123.071.156.2.17.375-.073-.074-.132-.122-.227-.112a1.495 1.495 0 0 1 .057-.263zm14.87 3.267c-.131.022-.365.07-.495.092-.348.059-.387.142-.441.484l-.086.524a9.16 9.16 0 0 1 .228-.568c.084-.184.132-.202.31-.3.127-.068.357-.163.483-.232zm-14.47 2.4c.274.946.738 1.876 1.255 2.657v.014a.993.993 0 0 1-.149.369c-.369.493-1.306-.23-1.578-.508-.297-.303-.496-.662-.543-.998-.034-.246-.001-.252.17-.426l.693-.701.153-.406zm12.405.62c.056.183.101.364.183.558.138.326.205.526.215.875l.032 1.106c.117.206.136.249.115.484-.043.481-.203.513-.625.506-.192-.003-.957-.007-1.15-.023-.274-.024-.429-.05-.512-.112.43-.316 1.162-1.619 1.304-2.068.151-.474.315-.888.438-1.326z"/></svg> </a> Débuter avec l'écosystème Hadoop </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=index.html class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=environnement.html class=md-nav__link> <span class=md-ellipsis> Préparation de l'environnement </span> </a> </li> <li class=md-nav__item> <a href=hdfs.html class=md-nav__link> <span class=md-ellipsis> Manipulation de HDFS </span> </a> </li> <li class=md-nav__item> <a href=mr.html class=md-nav__link> <span class=md-ellipsis> MapReduce en Python </span> </a> </li> <li class=md-nav__item> <a href=mrjava.html class=md-nav__link> <span class=md-ellipsis> MapReduce en Java </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Pig </span> <span class="md-nav__icon md-icon"></span> </label> <a href=pig.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Pig </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table des matières"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table des matières </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premier_exemple_wordcount class=md-nav__link> <span class=md-ellipsis> Premier exemple : Wordcount </span> </a> </li> <li class=md-nav__item> <a href=#execution_dun_script class=md-nav__link> <span class=md-ellipsis> Exécution d'un script </span> </a> </li> <li class=md-nav__item> <a href=#instructions_pig_par_lexemple class=md-nav__link> <span class=md-ellipsis> Instructions Pig par l'exemple </span> </a> </li> <li class=md-nav__item> <a href=#test_et_performances class=md-nav__link> <span class=md-ellipsis> Test et performances </span> </a> </li> <li class=md-nav__item> <a href=#references_pig_latin class=md-nav__link> <span class=md-ellipsis> Références Pig Latin </span> </a> </li> <li class=md-nav__item> <a href=#exercice class=md-nav__link> <span class=md-ellipsis> Exercice </span> </a> <nav class=md-nav aria-label=Exercice> <ul class=md-nav__list> <li class=md-nav__item> <a href=#datasets class=md-nav__link> <span class=md-ellipsis> Datasets </span> </a> </li> <li class=md-nav__item> <a href=#travail_a_faire class=md-nav__link> <span class=md-ellipsis> Travail à faire </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=hive.html class=md-nav__link> <span class=md-ellipsis> Hive </span> </a> </li> <li class=md-nav__item> <a href=ucase.html class=md-nav__link> <span class=md-ellipsis> Cas Pratique </span> </a> </li> <li class=md-nav__item> <a href=cluster.html class=md-nav__link> <span class=md-ellipsis> Hadoop en mode cluster </span> </a> </li> <li class=md-nav__item> <a href=solutions.html class=md-nav__link> <span class=md-ellipsis> Solutions </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <p><img src=assets/images/pig/pig.png width=30% height=30%></p> <h1 id=pig>Pig<a class=headerlink href=#pig title="Permanent link">&para;</a></h1> <hr> <h2 id=premier_exemple_wordcount>Premier exemple : Wordcount<a class=headerlink href=#premier_exemple_wordcount title="Permanent link">&para;</a></h2> <p>Nous reprenons l'exemple de comptage de mots utilisé dans l'atelier MapReduce pour le résoudre avec le langage Pig Latin.</p> <details class=info open=open> <summary>Structure d'un script Pig</summary> <p>Un script Pig comporte 3 phases :</p> <div class=highlight><pre><span></span><code>1. Le chargement des données avec LOAD
2. Une série de transformations
3. L&#39;affichage ou la sauvegarde des résultats
</code></pre></div> </details> <p><img alt=1⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/31-20e3.svg title=:one:> Lancer la machine virtuelle et accéder à Pig en mode interactif à partir du terminal</p> <p><div class=highlight><pre><span></span><code>pig<span class=w> </span>-x<span class=w> </span>mapreduce
</code></pre></div> Vous serez alors redirigé vers le shell grunt :</p> <div class=highlight><pre><span></span><code>grunt&gt;
</code></pre></div> <p><img alt=2⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/32-20e3.svg title=:two:> Charger le fichier <code>shakespeare.txt</code></p> <p><div class=highlight><pre><span></span><code>lines<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;./shakespeare.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>);</span>
</code></pre></div> Ce qui charge le contenu du fichier à partir de HDFS sous la forme de bag de chararray dans la variable lines.</p> <p><img alt=3⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/33-20e3.svg title=:three:> Décomposer chaque ligne en mots</p> <p><div class=highlight><pre><span></span><code>words<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>lines<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>FLATTEN</span><span class=p>(</span><span class=nb>TOKENIZE</span><span class=p>(</span>line<span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span>word;
</code></pre></div> <strong>TOKENIZE</strong> : Découper la ligne en bag de mots <strong>FLATTEN</strong> : Transformer le bag en des mots individuels</p> <p><img alt=4⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/34-20e3.svg title=:four:> Créer un groupe pour chaque mot</p> <div class=highlight><pre><span></span><code>word_groups<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span>words<span class=w> </span><span class=k>BY</span><span class=w> </span>word;
</code></pre></div> <p><img alt=5⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/35-20e3.svg title=:five:> Compter les éléments de chaque groupe</p> <div class=highlight><pre><span></span><code>word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>word_groups<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>words<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>count</span><span class=o>,</span><span class=w> </span><span class=k>group</span><span class=p>;</span>
</code></pre></div> <p><img alt=6⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/36-20e3.svg title=:six:> Trier par le nombre d'occurences</p> <p><div class=highlight><pre><span></span><code>ordered_word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span>word_count<span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</code></pre></div> <img alt=7⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/37-20e3.svg title=:seven:> Sauvegarder sur HDFS</p> <p><div class=highlight><pre><span></span><code><span class=k>STORE</span><span class=w> </span>ordered_word_count<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;./word_count_result&#39;</span><span class=p>;</span>
</code></pre></div> Après l'envoi de cette instruction, Pig crée un job MapReduce. Vérifier la progression sur <a href=http://localhost:8088>http://localhost:8088</a></p> <p><img src=assets/images/pig/wordcount.png width=90%></p> <p>Un dossier <code>word_count_result</code> est créé où des fichiers part-r-???? contiennent les nombres d'occurences associés aux mots du fichier.</p> <p><img alt=8⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/38-20e3.svg title=:eight:> Afficher le résultat</p> <div class=highlight><pre><span></span><code>hadoop<span class=w> </span>fs<span class=w> </span>-cat<span class=w> </span>word_count_result/part-r-*<span class=w> </span><span class=p>|</span><span class=w> </span>more
</code></pre></div> <p>Vous pouvez aussi utiliser l'interface web de HDFS pour afficher le résultat dans le dossier 'word_count_result'</p> <h2 id=execution_dun_script>Exécution d'un script<a class=headerlink href=#execution_dun_script title="Permanent link">&para;</a></h2> <p>Pour exécuter l'exemple précédent :</p> <p><img alt=1⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/31-20e3.svg title=:one:> Créer un fichier <code>wordcount.pig</code> avec un éditeur de texte (geany) avec le code suivant :</p> <p><div class=highlight><pre><span></span><code>lines<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;./shakespeare.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>);</span>
words<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>lines<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>FLATTEN</span><span class=p>(</span><span class=nb>TOKENIZE</span><span class=p>(</span>line<span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span>word;
word_groups<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span>words<span class=w> </span><span class=k>BY</span><span class=w> </span>word;
word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>word_groups<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>words<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>count</span><span class=o>,</span><span class=w> </span><span class=k>group</span><span class=p>;</span>
ordered_word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span>word_count<span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
<span class=k>STORE</span><span class=w> </span>ordered_word_count<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;./word_count_result&#39;</span><span class=p>;</span>
</code></pre></div> <img alt=2⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/32-20e3.svg title=:two:> Exécuter le script avec la commande suivante</p> <div class=highlight><pre><span></span><code>pig<span class=w> </span>-x<span class=w> </span>mapreduce<span class=w> </span>wordcount.pig
</code></pre></div> <details class=info open=open> <summary>Mode local</summary> <p>Avant de lancer un script pig, il est recommandé de le tester en local. Ceci est possible avec la commande suivante : <div class=highlight><pre><span></span><code>pig<span class=w> </span>-x<span class=w> </span><span class=nb>local</span><span class=w> </span>wordcount.pig
</code></pre></div></p> <p><strong>Attention :</strong> dans ce mode d'exécution les chemins sont interprétés dans le système local et non HDFS.</p> </details> <h2 id=instructions_pig_par_lexemple>Instructions Pig par l'exemple<a class=headerlink href=#instructions_pig_par_lexemple title="Permanent link">&para;</a></h2> <details class=warning open=open> <summary>Préparer les données</summary> <ol> <li>Créer un dossier <strong>demo</strong> : <code class=highlight>mkdir<span class=w> </span>~/demo</code></li> <li>Télécharger les fichiers csv dans /home/uti/demo :<ul> <li><a href=assets/employee.csv>employee.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span></a></li> <li><a href=assets/department.csv>department.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span></a></li> <li><a href=assets/salary.csv>salary.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span></a></li> </ul> </li> <li>Envoyer les données sur HDFS <div class=highlight><pre><span></span><code>hadoop<span class=w> </span>fs<span class=w> </span>-put<span class=w> </span>/home/uti/demo
</code></pre></div></li> </ol> </details> <p><img alt=1⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/31-20e3.svg title=:one:> Charger des données sans schéma à partir d'un fichier CSV avec ',' comme séparateur. Puis limiter le nombre de tuples à 10</p> <div class=highlight><pre><span></span><code>e1<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>);</span>
e1_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>e1<span class=w> </span><span class=mi>10</span><span class=p>;</span>
<span class=k>dump</span><span class=w> </span>e1_sample;
</code></pre></div> <p><img alt=2⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/32-20e3.svg title=:two:> Charger avec un schéma</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span>
<span class=k>as</span><span class=w> </span><span class=p>(</span>eid:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>department:<span class=kt>chararray</span><span class=p>);</span>
emp_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>emp<span class=w> </span><span class=mi>10</span><span class=p>;</span>
<span class=k>dump</span><span class=w> </span>emp_sample;
</code></pre></div> <p><img alt=3⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/33-20e3.svg title=:three:> Projection</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span>
<span class=k>as</span><span class=w> </span><span class=p>(</span>eid:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>department:<span class=kt>chararray</span><span class=p>);</span>
emp_proj<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>emp<span class=w> </span><span class=k>GENERATE</span><span class=w> </span>$1,<span class=w> </span>lname;
emp_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>emp_proj<span class=w> </span><span class=mi>10</span><span class=p>;</span>
<span class=k>dump</span><span class=w> </span>emp_sample;
</code></pre></div> <p><img alt=4⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/34-20e3.svg title=:four:> Filtrage pour avoir les employés (sans doublons) ayant reçu un salaire compris entre 5000 et 7000</p> <div class=highlight><pre><span></span><code>sal<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/salary.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>salary_id:<span class=kt>chararray</span><span class=o>,</span>employ_id:<span class=kt>chararray</span><span class=o>,</span>payment:<span class=kt>double</span><span class=o>,</span>p_date:<span class=kt>datetime</span><span class=p>);</span>
above_5k_7k<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=p>(</span><span class=k>FILTER</span><span class=w> </span>sal<span class=w> </span><span class=k>BY</span><span class=w> </span>payment<span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>5000</span><span class=w> </span><span class=k>AND</span><span class=w> </span>payment<span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>7000</span><span class=p>);</span>
emp_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>above_5k_7k<span class=w> </span><span class=mi>10</span><span class=p>;</span>
<span class=k>dump</span><span class=w> </span>emp_sample;
</code></pre></div> <p><img alt=5⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/35-20e3.svg title=:five:> Nombre d'employés par département et afficher les 3 plus grands départements</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>eid:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>department:<span class=kt>chararray</span><span class=p>);</span>
emp_group_dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>group</span><span class=w> </span>emp<span class=w> </span><span class=k>by</span><span class=w> </span>department;
<span class=c>-- ou emp_group_dep = group emp by $3;</span>
group_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>emp_group_dep<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>AS</span><span class=w> </span>dep,<span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>emp.eid<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span>nb_emp;
nbemp_dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span>group_count<span class=w> </span><span class=k>BY</span><span class=w> </span>nb_emp<span class=w> </span><span class=k>DESC</span><span class=p>;</span>
top_dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>nbemp_dep<span class=w> </span><span class=mi>3</span><span class=p>;</span>
<span class=k>dump</span><span class=w> </span>top_dep;
</code></pre></div> <p><img alt=6⃣ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/36-20e3.svg title=:six:> Jointure : trouver le nom du département de chaque employé</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>emp_id:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>dept_id:<span class=kt>chararray</span><span class=p>);</span>

dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/department.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>dept_id:<span class=kt>chararray</span><span class=o>,</span>dept_name:<span class=kt>chararray</span><span class=p>);</span>

dep_emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=p>(</span><span class=k>FOREACH</span><span class=w> </span><span class=p>(</span><span class=k>JOIN</span><span class=w> </span>emp<span class=w> </span><span class=k>by</span><span class=w> </span><span class=p>(</span>dept_id<span class=p>)</span><span class=o>,</span><span class=w> </span>dep<span class=w> </span><span class=k>by</span><span class=w> </span><span class=p>(</span>dept_id<span class=p>))</span><span class=w> </span><span class=k>GENERATE</span><span class=w> </span>fname,<span class=w> </span>lname,<span class=w> </span>dept_name<span class=p>)</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
<span class=k>DUMP</span><span class=w> </span>dep_emp;
</code></pre></div> <h2 id=test_et_performances>Test et performances<a class=headerlink href=#test_et_performances title="Permanent link">&para;</a></h2> <p><strong>DESCRIBE</strong></p> <p>Elle permet d'afficher le schéma d'une relation.</p> <p><strong>Exemple</strong></p> <p><div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span>lines<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;./shakespeare.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>);</span>
grunt&gt;<span class=w> </span>words<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>lines<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>FLATTEN</span><span class=p>(</span><span class=nb>TOKENIZE</span><span class=p>(</span>line<span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span>word;
grunt&gt;<span class=w> </span>word_groups<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span>words<span class=w> </span><span class=k>BY</span><span class=w> </span>word;
grunt&gt;<span class=w> </span>word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>word_groups<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>words<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>count</span><span class=o>,</span><span class=w> </span><span class=k>group</span><span class=p>;</span>
grunt&gt;<span class=w> </span><span class=k>DESCRIBE</span><span class=w> </span>lines;
lines:<span class=w> </span><span class=p>{</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>}</span>
grunt&gt;<span class=w> </span>DECRIBE<span class=w> </span>word_groups;
word_groups:<span class=w> </span><span class=p>{</span><span class=k>group</span>:<span class=w> </span><span class=kt>chararray</span><span class=o>,</span>words:<span class=w> </span><span class=p>{</span>word:<span class=w> </span><span class=kt>chararray</span><span class=p>}}</span>
grunt&gt;<span class=w> </span>DESCRIBEvword_count;
word_count:<span class=w> </span><span class=p>{</span><span class=nb>count</span>:<span class=w> </span><span class=kt>long</span><span class=o>,</span><span class=k>group</span>:<span class=w> </span><span class=kt>chararray</span><span class=p>}</span>
</code></pre></div> <strong>ILLUSTRATE</strong></p> <p>Cette commande Pig permet de montrer les différentes transformations effectuées sur les données.</p> <div class=highlight><pre><span></span><code><span class=k>ILLUSTRATE</span><span class=w> </span>relation|-script<span class=w> </span><span class=o>&lt;</span>nom_script&gt;
</code></pre></div> <p><strong>Exemple :</strong> (source <a href=http://pig.apache.org>http://pig.apache.org</a>)</p> <p><div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span><span class=k>cat</span><span class=w> </span>visits.txt
Amy<span class=w>     </span>yahoo.com<span class=w>       </span><span class=mi>19990421</span>
Fred<span class=w>    </span>harvard.edu<span class=w>     </span><span class=mi>19991104</span>
Amy<span class=w>     </span>cnn.com<span class=w> </span><span class=mi>20070218</span>
Frank<span class=w>   </span>nba.com<span class=w> </span><span class=mi>20070305</span>
Fred<span class=w>    </span>berkeley.edu<span class=w>    </span><span class=mi>20071204</span>
Fred<span class=w>    </span>stanford.edu<span class=w>    </span><span class=mi>20071206</span>

grunt&gt;<span class=w> </span><span class=k>cat</span><span class=w> </span>visits.pig
visits<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;visits.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>user,<span class=w> </span>url,<span class=w> </span>timestamp<span class=p>);</span>
recent_visits<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FILTER</span><span class=w> </span>visits<span class=w> </span><span class=k>BY</span><span class=w> </span>timestamp<span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s>&#39;20071201&#39;</span><span class=p>;</span>
historical_visits<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FILTER</span><span class=w> </span>visits<span class=w> </span><span class=k>BY</span><span class=w> </span>timestamp<span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s>&#39;20000101&#39;</span><span class=p>;</span>
<span class=k>DUMP</span><span class=w> </span>recent_visits;
<span class=k>DUMP</span><span class=w> </span>historical_visits;
<span class=k>STORE</span><span class=w> </span>recent_visits<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;recent&#39;</span><span class=p>;</span>
<span class=k>STORE</span><span class=w> </span>historical_visits<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;historical&#39;</span><span class=p>;</span>

grunt&gt;<span class=w> </span>exec<span class=w> </span>visits.pig

<span class=p>(</span>Fred,berkeley.edu,20071204<span class=p>)</span>
<span class=p>(</span>Fred,stanford.edu,20071206<span class=p>)</span>

<span class=p>(</span>Amy,yahoo.com,19990421<span class=p>)</span>
<span class=p>(</span>Fred,harvard.edu,19991104<span class=p>)</span>


grunt&gt;<span class=w> </span><span class=k>illustrate</span><span class=w> </span><span class=o>-</span>script<span class=w> </span>visits.pig

<span class=c>------------------------------------------------------------------------</span>
|<span class=w> </span>visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|
<span class=c>------------------------------------------------------------------------</span>
|<span class=w>            </span>|<span class=w> </span>Amy<span class=w>             </span>|<span class=w> </span>yahoo.com<span class=w>      </span>|<span class=w> </span><span class=mi>19990421</span><span class=w>             </span>|
|<span class=w>            </span>|<span class=w> </span>Fred<span class=w>            </span>|<span class=w> </span>stanford.edu<span class=w>   </span>|<span class=w> </span><span class=mi>20071206</span><span class=w>             </span>|
<span class=c>------------------------------------------------------------------------</span>
<span class=c>-------------------------------------------------------------------------------</span>
|<span class=w> </span>recent_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|
<span class=c>-------------------------------------------------------------------------------</span>
|<span class=w>                   </span>|<span class=w> </span>Fred<span class=w>            </span>|<span class=w> </span>stanford.edu<span class=w>   </span>|<span class=w> </span><span class=mi>20071206</span><span class=w>             </span>|
<span class=c>-------------------------------------------------------------------------------</span>
<span class=c>---------------------------------------------------------------------------------------</span>
|<span class=w> </span><span class=k>Store</span><span class=w> </span>:<span class=w> </span>recent_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|
<span class=c>---------------------------------------------------------------------------------------</span>
|<span class=w>                           </span>|<span class=w> </span>Fred<span class=w>            </span>|<span class=w> </span>stanford.edu<span class=w>   </span>|<span class=w> </span><span class=mi>20071206</span><span class=w>             </span>|
<span class=c>---------------------------------------------------------------------------------------</span>
<span class=c>-----------------------------------------------------------------------------------</span>
|<span class=w> </span>historical_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|
<span class=c>-----------------------------------------------------------------------------------</span>
|<span class=w>                       </span>|<span class=w> </span>Amy<span class=w>             </span>|<span class=w> </span>yahoo.com<span class=w>      </span>|<span class=w> </span><span class=mi>19990421</span><span class=w>             </span>|
<span class=c>-----------------------------------------------------------------------------------</span>
<span class=c>-------------------------------------------------------------------------------------------</span>
|<span class=w> </span><span class=k>Store</span><span class=w> </span>:<span class=w> </span>historical_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|
<span class=c>-------------------------------------------------------------------------------------------</span>
|<span class=w>                               </span>|<span class=w> </span>Amy<span class=w>             </span>|<span class=w> </span>yahoo.com<span class=w>      </span>|<span class=w> </span><span class=mi>19990421</span><span class=w>             </span>|
<span class=c>-------------------------------------------------------------------------------------------</span>
</code></pre></div> <strong>EXPLAIN</strong></p> <p>Affiche les plans d'exécution logique, physique et les phases MapReduce.</p> <div class=highlight><pre><span></span><code><span class=k>EXPLAIN</span><span class=w> </span>relation|-script<span class=w> </span><span class=o>&lt;</span>nom_script&gt;<span class=w> </span><span class=p>[</span><span class=o>-</span>out<span class=w> </span>chemin]<span class=w> </span><span class=p>[</span><span class=o>-</span>dot|-xml]
</code></pre></div> <p><strong>Exemple</strong></p> <div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span><span class=k>EXPLAIN</span><span class=w> </span><span class=o>-</span>script<span class=w> </span>wordcount.pig<span class=w> </span><span class=o>-</span>out<span class=w> </span>explain_wordcount.txt
</code></pre></div> <p>Le fichier <code>explain_wordcount.txt</code> obtenu contient :</p> <div class=highlight><pre><span></span><code><span class=c1>#-----------------------------------------------</span>
<span class=c1># New Logical Plan:</span>
<span class=c1>#-----------------------------------------------</span>
ordered_word_count:<span class=w> </span><span class=o>(</span>Name:<span class=w> </span>LOStore<span class=w> </span>Schema:<span class=w> </span>count#112:long,group#109:chararray<span class=o>)</span>
<span class=p>|</span>
<span class=p>|</span>---ordered_word_count:<span class=w> </span><span class=o>(</span>Name:<span class=w> </span>LOSort<span class=w> </span>Schema:<span class=w> </span>count#112:long,group#109:chararray<span class=o>)</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>count:<span class=o>(</span>Name:<span class=w> </span>Project<span class=w> </span>Type:<span class=w> </span>long<span class=w> </span>Uid:<span class=w> </span><span class=m>112</span><span class=w> </span>Input:<span class=w> </span><span class=m>0</span><span class=w> </span>Column:<span class=w> </span><span class=m>0</span><span class=o>)</span>
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---word_count:<span class=w> </span><span class=o>(</span>Name:<span class=w> </span>LOForEach<span class=w> </span>Schema:<span class=w> </span>count#112:long,group#109:chararray<span class=o>)</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=o>(</span>Name:<span class=w> </span>LOGenerate<span class=o>[</span>false,false<span class=o>]</span><span class=w> </span>Schema:<span class=w> </span>count#112:long,group#109:chararray<span class=o>)</span>ColumnPrune:OutputUids<span class=o>=[</span><span class=m>112</span>,<span class=w> </span><span class=m>109</span><span class=o>]</span>ColumnPrune:InputUids<span class=o>=[</span><span class=m>109</span>,<span class=w> </span><span class=m>110</span><span class=o>]</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=o>(</span>Name:<span class=w> </span>UserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=o>)</span><span class=w> </span>Type:<span class=w> </span>long<span class=w> </span>Uid:<span class=w> </span><span class=m>112</span><span class=o>)</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---words:<span class=o>(</span>Name:<span class=w> </span>Project<span class=w> </span>Type:<span class=w> </span>bag<span class=w> </span>Uid:<span class=w> </span><span class=m>110</span><span class=w> </span>Input:<span class=w> </span><span class=m>0</span><span class=w> </span>Column:<span class=w> </span><span class=o>(</span>*<span class=o>))</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span>group:<span class=o>(</span>Name:<span class=w> </span>Project<span class=w> </span>Type:<span class=w> </span>chararray<span class=w> </span>Uid:<span class=w> </span><span class=m>109</span><span class=w> </span>Input:<span class=w> </span><span class=m>1</span><span class=w> </span>Column:<span class=w> </span><span class=o>(</span>*<span class=o>))</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---words:<span class=w> </span><span class=o>(</span>Name:<span class=w> </span>LOInnerLoad<span class=o>[</span><span class=m>1</span><span class=o>]</span><span class=w> </span>Schema:<span class=w> </span>word#109:chararray<span class=o>)</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---<span class=o>(</span>Name:<span class=w> </span>LOInnerLoad<span class=o>[</span><span class=m>0</span><span class=o>]</span><span class=w> </span>Schema:<span class=w> </span>group#109:chararray<span class=o>)</span>
<span class=w>        </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span>---word_groups:<span class=w> </span><span class=o>(</span>Name:<span class=w> </span>LOCogroup<span class=w> </span>Schema:<span class=w> </span>group#109:chararray,words#110:bag<span class=o>{</span><span class=c1>#114:tuple(word#109:chararray)})</span>
<span class=w>            </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>            </span><span class=p>|</span><span class=w>   </span>word:<span class=o>(</span>Name:<span class=w> </span>Project<span class=w> </span>Type:<span class=w> </span>chararray<span class=w> </span>Uid:<span class=w> </span><span class=m>109</span><span class=w> </span>Input:<span class=w> </span><span class=m>0</span><span class=w> </span>Column:<span class=w> </span><span class=m>0</span><span class=o>)</span>
<span class=w>            </span><span class=p>|</span>
<span class=w>            </span><span class=p>|</span>---words:<span class=w> </span><span class=o>(</span>Name:<span class=w> </span>LOForEach<span class=w> </span>Schema:<span class=w> </span>word#118:chararray<span class=o>)</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=o>(</span>Name:<span class=w> </span>LOGenerate<span class=o>[</span>true<span class=o>]</span><span class=w> </span>Schema:<span class=w> </span>word#118:chararray<span class=o>)</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=o>(</span>Name:<span class=w> </span>UserFunc<span class=o>(</span>org.apache.pig.builtin.TOKENIZE<span class=o>)</span><span class=w> </span>Type:<span class=w> </span>bag<span class=w> </span>Uid:<span class=w> </span><span class=m>116</span><span class=o>)</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---<span class=o>(</span>Name:<span class=w> </span>Cast<span class=w> </span>Type:<span class=w> </span>chararray<span class=w> </span>Uid:<span class=w> </span><span class=m>98</span><span class=o>)</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>       </span><span class=p>|</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>       </span><span class=p>|</span>---line:<span class=o>(</span>Name:<span class=w> </span>Project<span class=w> </span>Type:<span class=w> </span>bytearray<span class=w> </span>Uid:<span class=w> </span><span class=m>98</span><span class=w> </span>Input:<span class=w> </span><span class=m>0</span><span class=w> </span>Column:<span class=w> </span><span class=o>(</span>*<span class=o>))</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>                </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---<span class=o>(</span>Name:<span class=w> </span>LOInnerLoad<span class=o>[</span><span class=m>0</span><span class=o>]</span><span class=w> </span>Schema:<span class=w> </span>line#98:bytearray<span class=o>)</span>
<span class=w>                </span><span class=p>|</span>
<span class=w>                </span><span class=p>|</span>---lines:<span class=w> </span><span class=o>(</span>Name:<span class=w> </span>LOLoad<span class=w> </span>Schema:<span class=w> </span>line#98:bytearray<span class=o>)</span>RequiredFields:null
<span class=c1>#-----------------------------------------------</span>
<span class=c1># Physical Plan:</span>
<span class=c1>#-----------------------------------------------</span>
ordered_word_count:<span class=w> </span>Store<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/word_count_result:org.apache.pig.builtin.PigStorage<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-18
<span class=p>|</span>
<span class=p>|</span>---ordered_word_count:<span class=w> </span>POSort<span class=o>[</span>bag<span class=o>]()</span><span class=w> </span>-<span class=w> </span>scope-17
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>long<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-16
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---word_count:<span class=w> </span>New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-15
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span>POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=o>)[</span>long<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-11
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-10
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-13
<span class=w>        </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span>---word_groups:<span class=w> </span>Package<span class=o>(</span>Packager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span><span class=w> </span>-<span class=w> </span>scope-7
<span class=w>            </span><span class=p>|</span>
<span class=w>            </span><span class=p>|</span>---word_groups:<span class=w> </span>Global<span class=w> </span>Rearrange<span class=o>[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-6
<span class=w>                </span><span class=p>|</span>
<span class=w>                </span><span class=p>|</span>---word_groups:<span class=w> </span>Local<span class=w> </span>Rearrange<span class=o>[</span>tuple<span class=o>]{</span>chararray<span class=o>}(</span><span class=nb>false</span><span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-8
<span class=w>                    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>                    </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-9
<span class=w>                    </span><span class=p>|</span>
<span class=w>                    </span><span class=p>|</span>---words:<span class=w> </span>New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span><span class=nb>true</span><span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-5
<span class=w>                        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>                        </span><span class=p>|</span><span class=w>   </span>POUserFunc<span class=o>(</span>org.apache.pig.builtin.TOKENIZE<span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-3
<span class=w>                        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>                        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---Cast<span class=o>[</span>chararray<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-2
<span class=w>                        </span><span class=p>|</span><span class=w>       </span><span class=p>|</span>
<span class=w>                        </span><span class=p>|</span><span class=w>       </span><span class=p>|</span>---Project<span class=o>[</span>bytearray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-1
<span class=w>                        </span><span class=p>|</span>
<span class=w>                        </span><span class=p>|</span>---lines:<span class=w> </span>Load<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/shakespeare.txt:org.apache.pig.builtin.PigStorage<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-0

<span class=c1>#--------------------------------------------------</span>
<span class=c1># Map Reduce Plan                                  </span>
<span class=c1>#--------------------------------------------------</span>
MapReduce<span class=w> </span>node<span class=w> </span>scope-19
Map<span class=w> </span>Plan
word_groups:<span class=w> </span>Local<span class=w> </span>Rearrange<span class=o>[</span>tuple<span class=o>]{</span>chararray<span class=o>}(</span><span class=nb>false</span><span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-53
<span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-55
<span class=p>|</span>
<span class=p>|</span>---word_count:<span class=w> </span>New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-42
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-43
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=nv>$Initial</span><span class=o>)[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-44
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-45
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---Pre<span class=w> </span>Combiner<span class=w> </span>Local<span class=w> </span>Rearrange<span class=o>[</span>tuple<span class=o>]{</span>Unknown<span class=o>}</span><span class=w> </span>-<span class=w> </span>scope-56
<span class=w>        </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span>---words:<span class=w> </span>New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span><span class=nb>true</span><span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-5
<span class=w>            </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>            </span><span class=p>|</span><span class=w>   </span>POUserFunc<span class=o>(</span>org.apache.pig.builtin.TOKENIZE<span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-3
<span class=w>            </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>            </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---Cast<span class=o>[</span>chararray<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-2
<span class=w>            </span><span class=p>|</span><span class=w>       </span><span class=p>|</span>
<span class=w>            </span><span class=p>|</span><span class=w>       </span><span class=p>|</span>---Project<span class=o>[</span>bytearray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-1
<span class=w>            </span><span class=p>|</span>
<span class=w>            </span><span class=p>|</span>---lines:<span class=w> </span>Load<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/shakespeare.txt:org.apache.pig.builtin.PigStorage<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-0--------
Combine<span class=w> </span>Plan
word_groups:<span class=w> </span>Local<span class=w> </span>Rearrange<span class=o>[</span>tuple<span class=o>]{</span>chararray<span class=o>}(</span><span class=nb>false</span><span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-57
<span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-59
<span class=p>|</span>
<span class=p>|</span>---word_count:<span class=w> </span>New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-46
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-47
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=nv>$Intermediate</span><span class=o>)[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-48
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-49
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---word_groups:<span class=w> </span>Package<span class=o>(</span>CombinerPackager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span><span class=w> </span>-<span class=w> </span>scope-52--------
Reduce<span class=w> </span>Plan
Store<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp-1292167423:org.apache.pig.impl.io.InterStorage<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-20
<span class=p>|</span>
<span class=p>|</span>---word_count:<span class=w> </span>New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-15
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=nv>$Final</span><span class=o>)[</span>long<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-11
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-50
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-13
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---word_groups:<span class=w> </span>Package<span class=o>(</span>CombinerPackager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span><span class=w> </span>-<span class=w> </span>scope-7--------
Global<span class=w> </span>sort:<span class=w> </span><span class=nb>false</span>
----------------

MapReduce<span class=w> </span>node<span class=w> </span>scope-22
Map<span class=w> </span>Plan
ordered_word_count:<span class=w> </span>Local<span class=w> </span>Rearrange<span class=o>[</span>tuple<span class=o>]{</span>tuple<span class=o>}(</span><span class=nb>false</span><span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-26
<span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=p>|</span><span class=w>   </span>Constant<span class=o>(</span>all<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-25
<span class=p>|</span>
<span class=p>|</span>---New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span><span class=nb>false</span><span class=o>)[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-24
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>long<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-23
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---Load<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp-1292167423:org.apache.pig.impl.builtin.RandomSampleLoader<span class=o>(</span><span class=s1>&#39;org.apache.pig.impl.io.InterStorage&#39;</span>,<span class=s1>&#39;100&#39;</span><span class=o>))</span><span class=w> </span>-<span class=w> </span>scope-21--------
Reduce<span class=w> </span>Plan
Store<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp569443691:org.apache.pig.impl.io.InterStorage<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-35
<span class=p>|</span>
<span class=p>|</span>---New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span><span class=nb>false</span><span class=o>)[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-34
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>POUserFunc<span class=o>(</span>org.apache.pig.impl.builtin.FindQuantiles<span class=o>)[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-33
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>---Project<span class=o>[</span>tuple<span class=o>][</span>*<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-32
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span>false,false<span class=o>)[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-31
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span>Constant<span class=o>(</span>-1<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-30
<span class=w>        </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-28
<span class=w>        </span><span class=p>|</span>
<span class=w>        </span><span class=p>|</span>---Package<span class=o>(</span>Packager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span><span class=w> </span>-<span class=w> </span>scope-27--------
Global<span class=w> </span>sort:<span class=w> </span><span class=nb>false</span>
Secondary<span class=w> </span>sort:<span class=w> </span><span class=nb>true</span>
----------------

MapReduce<span class=w> </span>node<span class=w> </span>scope-37
Map<span class=w> </span>Plan
ordered_word_count:<span class=w> </span>Local<span class=w> </span>Rearrange<span class=o>[</span>tuple<span class=o>]{</span>long<span class=o>}(</span><span class=nb>false</span><span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-38
<span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>long<span class=o>][</span><span class=m>0</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-16
<span class=p>|</span>
<span class=p>|</span>---Load<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp-1292167423:org.apache.pig.impl.io.InterStorage<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-36--------
Reduce<span class=w> </span>Plan
ordered_word_count:<span class=w> </span>Store<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/word_count_result:org.apache.pig.builtin.PigStorage<span class=o>)</span><span class=w> </span>-<span class=w> </span>scope-18
<span class=p>|</span>
<span class=p>|</span>---New<span class=w> </span>For<span class=w> </span>Each<span class=o>(</span><span class=nb>true</span><span class=o>)[</span>tuple<span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-41
<span class=w>    </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span><span class=w>   </span>Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span><span class=w> </span>-<span class=w> </span>scope-40
<span class=w>    </span><span class=p>|</span>
<span class=w>    </span><span class=p>|</span>---Package<span class=o>(</span>LitePackager<span class=o>)[</span>tuple<span class=o>]{</span>long<span class=o>}</span><span class=w> </span>-<span class=w> </span>scope-39--------
Global<span class=w> </span>sort:<span class=w> </span><span class=nb>true</span>
Quantile<span class=w> </span>file:<span class=w> </span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp569443691
----------------
</code></pre></div> <p>Pour avoir un graphe d'exécution :</p> <div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span><span class=k>EXPLAIN</span><span class=w> </span><span class=o>-</span>script<span class=w> </span>wordcount.pig<span class=w> </span><span class=o>-</span>out<span class=w> </span>explain_wordcount.dot<span class=w> </span><span class=o>-</span>dot
</code></pre></div> <p>Puis convertir le fichier .dot en png :</p> <div class=highlight><pre><span></span><code>apt<span class=w> </span>install<span class=w> </span>graphviz<span class=w> </span>-y
dot<span class=w> </span>-Tpng<span class=w> </span>-out<span class=w> </span>explain_wordcount.png<span class=w> </span>explain_wordcount.dot
</code></pre></div> <p>Ce qui donne :</p> <p><img src=assets/images/pig/explain_wordcount.png width=70%></p> <h2 id=references_pig_latin>Références Pig Latin<a class=headerlink href=#references_pig_latin title="Permanent link">&para;</a></h2> <p>Pour une référence complète du langage Pig Latin, aller sur la page de documentation (<a href=https://pig.apache.org/docs/r0.14.0/index.html title="Documentation Pig">ici</a>)</p> <p>Voici aussi, un mémo du langage :</p> <p><a href=assets/Pig-memo.pdf class="image fit" target=_blank><i class="fas fa-file-pdf"></i>Ouvrir dans un nouvel onglet</a></p> <object data=assets/Pig-memo.pdf type=application/pdf width=100% height=700> <embed src=assets/Pig-memo.pdf type=application/pdf> </object> <!--
## Exercice :computer:

### Datasets

- [airports.csv :fontawesome-solid-download:{.heart}](https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/HG7NV7/XTPZZY) : Les aéorports décrits par les champs :
    - 
<div class="highlight"><pre><span></span><code>1   iata    IATA airport code
2   airport Airport name
3   city    Airport city
4   state   USA state
5   country Airport country
6   lat     latitude
7   long    longitude
</code></pre></div>
- [2008.csv.bz2 :fontawesome-solid-download:{.heart}](https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/HG7NV7/EIR0RA) : Le détail des vols de l'année 2008 avec la structure suivante :
    - 
<div class="highlight"><pre><span></span><code>1    Year               1987-2008
2    Month              1-12
3    DayofMonth         1-31
4    DayOfWeek          1 (Monday) - 7 (Sunday)
5    DepTime            actual departure time (local, hhmm)
6    CRSDepTime         scheduled departure time (local, hhmm)
7    ArrTime            actual arrival time (local, hhmm)
8    CRSArrTime         scheduled arrival time (local, hhmm)
9    UniqueCarrier      unique carrier code
10   FlightNum          flight number
11   TailNum            plane tail number
12   ActualElapsedTime  in minutes
13   CRSElapsedTime     in minutes
14   AirTime            in minutes
15   ArrDelay           arrival delay, in minutes
16   DepDelay           departure delay, in minutes
17   Origin             origin IATA airport code
18   Dest               destination IATA airport code
19   Distance           in miles
20   TaxiIn             taxi in time, in minutes
21   TaxiOut            taxi out time in minutes
22   Cancelled          was the flight cancelled?
23   CancellationCode   reason for cancellation (A = carrier, B = weather, C = NAS, D = security)
24   Diverted           1 = yes, 0 = no
25   CarrierDelay       in minutes
26   WeatherDelay       in minutes
27   NASDelay           in minutes
28   SecurityDelay      in minutes
29   LateAircraftDelay  in minutes
</code></pre></div>

### Travail à faire

Après avoir chargé les fichiers dans HDFS, répondre aux questions suivantes avec un script Pig Latin pour chaque question :

1. Quels sont les lignes (source-destination) ayant des temps de vols de plus de 7 heures.
1. Quels sont les pays destination des vols retardés pour des raisons climatiques.
1. Quelle est la cause de l'annulation du plus grand nombre de vols.
1. Le Top 20 des aéoroports selon le nombre total des vols. Calculer pour chaque code d'aéropot de vols entrant et sortant par jour et par mois. 
1. Calculer la proportion des vols retardés (Un vol est considéré retardé si le délai est plus grand que 15mn).
1. Calculer la proportions des vols retardés par campagnie (carrier).
1. Quelles sont les lignes les plus sollicitées.
--> <h2 id=exercice>Exercice <img alt=💻 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f4bb.svg title=:computer:><a class=headerlink href=#exercice title="Permanent link">&para;</a></h2> <h3 id=datasets>Datasets<a class=headerlink href=#datasets title="Permanent link">&para;</a></h3> <p>Ci-après la description des données sur les crédits offerts par une banque à ses clients. (source : <a href=https://www.kaggle.com>https://www.kaggle.com</a> <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 320 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"/></svg></span>) Le fichier <a href=assets/credit_risk_dataset.csv>credit_risk_dataset.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span></a> est structuré ainsi :</p> <div class=highlight><pre><span></span><code>person_age :                âge du client
person_income :             revenu annuel du client
person_home_ownership :     propriété de la maison : OWN, RENT, MORTGAGE
person_emp_length :         durée en mois du crédit
loan_intent :               motif du crédit (MEDICAL, EDUCATION, PERSONAL, ...)
loan_grade :                A, B, C, D
loan_amnt :                 montant du crédit
loan_int_rate :             taux d&#39;intérêt
loan_status :               état du crédit (1: non remboursé, 0: remboursé)
loan_percent_income :       pourcentage du montant du crédit par rapport au revenu
cb_person_default_on_file : Y/N
cb_person_cred_hist_length :historique (nombre de crédits)
</code></pre></div> <h3 id=travail_a_faire>Travail à faire<a class=headerlink href=#travail_a_faire title="Permanent link">&para;</a></h3> <p>Répondre aux questions suivantes avec Pig.</p> <ol> <li>Calculer le montant total et la durée moyenne des crédits non remboursés.</li> <li>Calculer le pourcentage des crédits remboursés et non remboursés.</li> <li>Quelle est la distribution des différents états de propriété de la maison.</li> <li>Quels sont les 3 motifs de crédits les plus demandés.</li> <li>Calculer le pourcentage des crédits remboursés et non remboursés par motif puis par grade. </li> </ol> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Retour en haut de la page </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label="Pied de page"> <a href=mrjava.html class="md-footer__link md-footer__link--prev" aria-label="Précédent: MapReduce en Java"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Précédent </span> <div class=md-ellipsis> MapReduce en Java </div> </div> </a> <a href=hive.html class="md-footer__link md-footer__link--next" aria-label="Suivant: Hive"> <div class=md-footer__title> <span class=md-footer__direction> Suivant </span> <div class=md-ellipsis> Hive </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - Dr. Hmida Hmida </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://gitlab.com/hhmida target=_blank rel=noopener title=gitlab.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81-2.9-.295-5.7.083-8.4 1.11-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.09 18.09 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3 4.7 0 9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82z"/></svg> </a> <a href=https://github.com/hhmida target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://linkedin.com/in/hhmida target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.instant.progress", "navigation.top", "toc.integrate", "content.code.annotate", "content.code.copy", "navigation.footer"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}}</script> <script src=assets/javascripts/bundle.8fd75fb4.min.js></script> </body> </html>