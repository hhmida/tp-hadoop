<!doctype html><html lang=fr class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Atelier Hadoop - HDFS - MapReduce - Pig - Hive"><meta name=author content="Hmida Hmida"><link rel=canonical href=https://hhmida.github.io/tp-hadoop-iset/pig.html><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.4"><title>Pig - Débuter avec l'écosystème Hadoop</title><link rel=stylesheet href=assets/stylesheets/main.6b80c2a2.min.css><link rel=stylesheet href=assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=assets/stylesheets/extra.css><script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=red> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#pig class=md-skip> Aller au contenu </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=En-tête> <a href=index.html title="Débuter avec l'écosystème Hadoop" class="md-header__button md-logo" aria-label="Débuter avec l'écosystème Hadoop" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Débuter avec l'écosystème Hadoop </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Pig </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=red aria-label="Basculer au mode sombre" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Basculer au mode sombre" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=red aria-label="Basculer au mode clair" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Basculer au mode clair" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Rechercher placeholder=Rechercher autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Effacer tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initialisation de la recherche </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Onglets data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=index.html class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=hdfs.html class=md-tabs__link> Manipulation de HDFS </a> </li> <li class=md-tabs__item> <a href=mr.html class=md-tabs__link> MapReduce avec Python </a> </li> <li class=md-tabs__item> <a href=pig.html class="md-tabs__link md-tabs__link--active"> Pig </a> </li> <li class=md-tabs__item> <a href=hive.html class=md-tabs__link> Hive </a> </li> <li class=md-tabs__item> <a href=ucase.html class=md-tabs__link> Cas Pratique </a> </li> <li class=md-tabs__item> <a href=cluster.html class=md-tabs__link> Hadoop en mode cluster </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=index.html title="Débuter avec l'écosystème Hadoop" class="md-nav__button md-logo" aria-label="Débuter avec l'écosystème Hadoop" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> Débuter avec l'écosystème Hadoop </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=index.html class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=hdfs.html class=md-nav__link> Manipulation de HDFS </a> </li> <li class=md-nav__item> <a href=mr.html class=md-nav__link> MapReduce avec Python </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Pig <span class="md-nav__icon md-icon"></span> </label> <a href=pig.html class="md-nav__link md-nav__link--active"> Pig </a> <nav class="md-nav md-nav--secondary" aria-label="Table des matières"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table des matières </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premier_exemple_wordcount class=md-nav__link> Premier exemple : Wordcount </a> </li> <li class=md-nav__item> <a href=#execution_dun_script class=md-nav__link> Exécution d'un script </a> </li> <li class=md-nav__item> <a href=#instructions_pig_par_lexemple class=md-nav__link> Instructions Pig par l'exemple </a> </li> <li class=md-nav__item> <a href=#test_et_performances class=md-nav__link> Test et performances </a> </li> <li class=md-nav__item> <a href=#references_pig_latin class=md-nav__link> Références Pig Latin </a> </li> <li class=md-nav__item> <a href=#exercice class=md-nav__link> Exercice </a> <nav class=md-nav aria-label=Exercice> <ul class=md-nav__list> <li class=md-nav__item> <a href=#datasets class=md-nav__link> Datasets </a> </li> <li class=md-nav__item> <a href=#travail_a_faire class=md-nav__link> Travail à faire </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=hive.html class=md-nav__link> Hive </a> </li> <li class=md-nav__item> <a href=ucase.html class=md-nav__link> Cas Pratique </a> </li> <li class=md-nav__item> <a href=cluster.html class=md-nav__link> Hadoop en mode cluster </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <p><img src=assets/images/pig/pig.png width=30% height=30%></p> <h1 id=pig>Pig<a class=headerlink href=#pig title="Permanent link">&para;</a></h1> <hr> <h2 id=premier_exemple_wordcount>Premier exemple : Wordcount<a class=headerlink href=#premier_exemple_wordcount title="Permanent link">&para;</a></h2> <p>Nous reprenons l'exemple de comptage de mots utilisé dans l'atelier MapReduce pour le résoudre avec le langage Pig Latin.</p> <details class=info open=open> <summary>Structure d'un script Pig</summary> <p>Un script Pig comporte 3 phases :</p> <div class=highlight><pre><span></span><code>1. Le chargement des données avec LOAD
2. Une série de transformations
3. L&#39;affichage ou la sauvegarde des résultats
</code></pre></div> </details> <p><img alt=1⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/31-20e3.svg title=:one:> Lancer la machine virtuelle et accéder à Pig en mode interactif à partir du terminal</p> <p><div class=highlight><pre><span></span><code>pig -x mapreduce
</code></pre></div> Vous serez alors redirigé vers le shell grunt :</p> <div class=highlight><pre><span></span><code>grunt&gt;
</code></pre></div> <p><img alt=2⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/32-20e3.svg title=:two:> Charger le fichier <code>shakespeare.txt</code></p> <p><div class=highlight><pre><span></span><code>lines<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;./shakespeare.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>);</span><span class=w></span>
</code></pre></div> Ce qui charge le contenu du fichier à partir de HDFS sous la forme de bag de chararray dans la variable lines.</p> <p><img alt=3⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/33-20e3.svg title=:three:> Décomposer chaque ligne en mots</p> <p><div class=highlight><pre><span></span><code>words<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>lines<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>FLATTEN</span><span class=p>(</span><span class=nb>TOKENIZE</span><span class=p>(</span>line<span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span>word;<span class=w></span>
</code></pre></div> <strong>TOKENIZE</strong> : Découper la ligne en bag de mots <strong>FLATTEN</strong> : Transformer le bag en des mots individuels</p> <p><img alt=4⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/34-20e3.svg title=:four:> Créer un groupe pour chaque mot</p> <div class=highlight><pre><span></span><code>word_groups<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span>words<span class=w> </span><span class=k>BY</span><span class=w> </span>word;<span class=w></span>
</code></pre></div> <p><img alt=5⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/35-20e3.svg title=:five:> Compter les éléments de chaque groupe</p> <div class=highlight><pre><span></span><code>word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>word_groups<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>words<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>count</span><span class=o>,</span><span class=w> </span><span class=k>group</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p><img alt=6⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/36-20e3.svg title=:six:> Trier par le nombre d'occurences</p> <p><div class=highlight><pre><span></span><code>ordered_word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span>word_count<span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w></span>
</code></pre></div> <img alt=7⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/37-20e3.svg title=:seven:> Sauvegarder sur HDFS</p> <p><div class=highlight><pre><span></span><code><span class=k>STORE</span><span class=w> </span>ordered_word_count<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;./word_count_result&#39;</span><span class=p>;</span><span class=w></span>
</code></pre></div> Après l'envoi de cette instruction, Pig crée un job MapReduce. Vérifier la progression sur <a href=http://localhost:8088>http://localhost:8088</a></p> <p><img src=assets/images/pig/wordcount.png width=90%></p> <p>Un dossier <code>word_count_result</code> est créé où des fichiers part-r-???? contiennent les nombres d'occurences associés aux mots du fichier.</p> <p><img alt=8⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/38-20e3.svg title=:eight:> Afficher le résultat</p> <div class=highlight><pre><span></span><code>hadoop fs -cat word_count_result/part-r-* <span class=p>|</span> more
</code></pre></div> <p>Vous pouvez aussi utiliser l'interface web de HDFS pour afficher le résultat dans le dossier 'word_count_result'</p> <h2 id=execution_dun_script>Exécution d'un script<a class=headerlink href=#execution_dun_script title="Permanent link">&para;</a></h2> <p>Pour exécuter l'exemple précédent :</p> <p><img alt=1⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/31-20e3.svg title=:one:> Créer un fichier <code>wordcount.pig</code> avec un éditeur de texte (geany) avec le code suivant :</p> <p><div class=highlight><pre><span></span><code>lines<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;./shakespeare.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>);</span><span class=w></span>
words<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>lines<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>FLATTEN</span><span class=p>(</span><span class=nb>TOKENIZE</span><span class=p>(</span>line<span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span>word;<span class=w></span>
word_groups<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span>words<span class=w> </span><span class=k>BY</span><span class=w> </span>word;<span class=w></span>
word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>word_groups<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>words<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>count</span><span class=o>,</span><span class=w> </span><span class=k>group</span><span class=p>;</span><span class=w></span>
ordered_word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span>word_count<span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w></span>
<span class=k>STORE</span><span class=w> </span>ordered_word_count<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;./word_count_result&#39;</span><span class=p>;</span><span class=w></span>
</code></pre></div> <img alt=2⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/32-20e3.svg title=:two:> Exécuter le script avec la commande suivante</p> <div class=highlight><pre><span></span><code>pig -x mapreduce wordcount.pig
</code></pre></div> <details class=info open=open> <summary>Mode local</summary> <p>Avant de lancer un script pig, il est recommandé de le tester en local. Ceci est possible avec la commande suivante : <div class=highlight><pre><span></span><code>pig -x <span class=nb>local</span> wordcount.pig
</code></pre></div></p> <p><strong>Attention :</strong> dans ce mode d'exécution les chemins sont interprétés dans le système local et non HDFS.</p> </details> <h2 id=instructions_pig_par_lexemple>Instructions Pig par l'exemple<a class=headerlink href=#instructions_pig_par_lexemple title="Permanent link">&para;</a></h2> <details class=warning open=open> <summary>Préparer les données</summary> <ol> <li>Créer un dossier <strong>demo</strong> : <code class=highlight>mkdir ~/demo</code></li> <li>Télécharger les fichiers csv dans /home/uti/demo :<ul> <li><a href=assets/employee.csv>employee.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"/></svg></span></a></li> <li><a href=assets/department.csv>department.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"/></svg></span></a></li> <li><a href=assets/salary.csv>salary.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"/></svg></span></a></li> </ul> </li> <li>Envoyer les données sur HDFS <div class=highlight><pre><span></span><code>hadoop fs -put /home/uti/demo
</code></pre></div></li> </ol> </details> <p><img alt=1⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/31-20e3.svg title=:one:> Charger des données sans schéma à partir d'un fichier CSV avec ',' comme séparateur. Puis limiter le nombre de tuples à 10</p> <div class=highlight><pre><span></span><code>e1<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>);</span><span class=w></span>
e1_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>e1<span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w></span>
<span class=k>dump</span><span class=w> </span>e1_sample;<span class=w></span>
</code></pre></div> <p><img alt=2⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/32-20e3.svg title=:two:> Charger avec un schéma</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span>
<span class=k>as</span><span class=w> </span><span class=p>(</span>eid:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>department:<span class=kt>chararray</span><span class=p>);</span><span class=w></span>
emp_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>emp<span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w></span>
<span class=k>dump</span><span class=w> </span>emp_sample;<span class=w></span>
</code></pre></div> <p><img alt=3⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/33-20e3.svg title=:three:> Projection</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span>
<span class=k>as</span><span class=w> </span><span class=p>(</span>eid:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>department:<span class=kt>chararray</span><span class=p>);</span><span class=w></span>
emp_proj<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>emp<span class=w> </span><span class=k>GENERATE</span><span class=w> </span>$1,<span class=w> </span>lname;<span class=w></span>
emp_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>emp_proj<span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w></span>
<span class=k>dump</span><span class=w> </span>emp_sample;<span class=w></span>
</code></pre></div> <p><img alt=4⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/34-20e3.svg title=:four:> Filtrage pour avoir les employés (sans doublons) ayant reçu un salaire compris entre 5000 et 7000</p> <div class=highlight><pre><span></span><code>sal<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/salary.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>salary_id:<span class=kt>chararray</span><span class=o>,</span>employ_id:<span class=kt>chararray</span><span class=o>,</span>payment:<span class=kt>double</span><span class=o>,</span>p_date:<span class=kt>datetime</span><span class=p>);</span><span class=w></span>
above_5k_7k<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=p>(</span><span class=k>FILTER</span><span class=w> </span>sal<span class=w> </span><span class=k>BY</span><span class=w> </span>payment<span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>5000</span><span class=w> </span><span class=k>AND</span><span class=w> </span>payment<span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>7000</span><span class=p>);</span><span class=w></span>
emp_sample<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>emp<span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w></span>
<span class=k>dump</span><span class=w> </span>emp_sample;<span class=w></span>
</code></pre></div> <p><img alt=5⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/35-20e3.svg title=:five:> Nombre d'employés par département et afficher les 3 plus grands départements</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>eid:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>department:<span class=kt>chararray</span><span class=p>);</span><span class=w></span>
emp_group_dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>group</span><span class=w> </span>emp<span class=w> </span><span class=k>by</span><span class=w> </span>department;<span class=w></span>
<span class=c>-- ou emp_group_dep = group emp by $3;</span><span class=w></span>
nbemp_dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=p>(</span><span class=k>FOREACH</span><span class=w> </span>emp_group_dep<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>AS</span><span class=w> </span>dep,<span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>emp.eid<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span>nb_emp<span class=p>)</span><span class=w> </span><span class=k>BY</span><span class=w> </span>nb_emp<span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w></span>
top_dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>limit</span><span class=w> </span>nbemp_dep<span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w></span>
<span class=k>dump</span><span class=w> </span>top_dep;<span class=w></span>
</code></pre></div> <p><img alt=6⃣ class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/36-20e3.svg title=:six:> Jointure : trouver le nom du département de chaque employé</p> <div class=highlight><pre><span></span><code>emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/employee.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>emp_id:<span class=kt>chararray</span><span class=o>,</span>fname:<span class=kt>chararray</span><span class=o>,</span>lname:<span class=kt>chararray</span><span class=o>,</span>dept_id:<span class=kt>chararray</span><span class=p>);</span><span class=w></span>

dep<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;/user/uti/demo/department.csv&#39;</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=nb>PigStorage</span><span class=w> </span><span class=p>(</span><span class=s>&#39;,&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span>dept_id:<span class=kt>chararray</span><span class=o>,</span>dept_name:<span class=kt>chararray</span><span class=p>);</span><span class=w></span>

dep_emp<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=p>(</span><span class=k>FOREACH</span><span class=w> </span><span class=p>(</span><span class=k>JOIN</span><span class=w> </span>emp<span class=w> </span><span class=k>by</span><span class=w> </span><span class=p>(</span>dept_id<span class=p>)</span><span class=o>,</span><span class=w> </span>dep<span class=w> </span><span class=k>by</span><span class=w> </span><span class=p>(</span>dept_id<span class=p>))</span><span class=w> </span><span class=k>GENERATE</span><span class=w> </span>fname,<span class=w> </span>lname,<span class=w> </span>dept_name<span class=p>)</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w></span>
<span class=k>DUMP</span><span class=w> </span>dep_emp;<span class=w></span>
</code></pre></div> <h2 id=test_et_performances>Test et performances<a class=headerlink href=#test_et_performances title="Permanent link">&para;</a></h2> <p><strong>DESCRIBE</strong></p> <p>Elle permet d'afficher le schéma d'une relation.</p> <p><strong>Exemple</strong></p> <p><div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span>lines<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;./shakespeare.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>);</span><span class=w></span>
grunt&gt;<span class=w> </span>words<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>lines<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=k>FLATTEN</span><span class=p>(</span><span class=nb>TOKENIZE</span><span class=p>(</span>line<span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span>word;<span class=w></span>
grunt&gt;<span class=w> </span>word_groups<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span>words<span class=w> </span><span class=k>BY</span><span class=w> </span>word;<span class=w></span>
grunt&gt;<span class=w> </span>word_count<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FOREACH</span><span class=w> </span>word_groups<span class=w> </span><span class=k>GENERATE</span><span class=w> </span><span class=nb>COUNT</span><span class=p>(</span>words<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>count</span><span class=o>,</span><span class=w> </span><span class=k>group</span><span class=p>;</span><span class=w></span>
grunt&gt;<span class=w> </span><span class=k>DESCRIBE</span><span class=w> </span>lines;<span class=w></span>
lines:<span class=w> </span><span class=p>{</span>line:<span class=w> </span><span class=kt>chararray</span><span class=p>}</span><span class=w></span>
grunt&gt;<span class=w> </span>DECRIBE<span class=w> </span>word_groups;<span class=w></span>
word_groups:<span class=w> </span><span class=p>{</span><span class=k>group</span>:<span class=w> </span><span class=kt>chararray</span><span class=o>,</span>words:<span class=w> </span><span class=p>{</span>word:<span class=w> </span><span class=kt>chararray</span><span class=p>}}</span><span class=w></span>
grunt&gt;<span class=w> </span>DESCRIBEvword_count;<span class=w></span>
word_count:<span class=w> </span><span class=p>{</span><span class=nb>count</span>:<span class=w> </span><span class=kt>long</span><span class=o>,</span><span class=k>group</span>:<span class=w> </span><span class=kt>chararray</span><span class=p>}</span><span class=w></span>
</code></pre></div> <strong>ILLUSTRATE</strong></p> <p>Cette commande Pig permet de montrer les différentes transformations effectuées sur les données.</p> <div class=highlight><pre><span></span><code><span class=k>ILLUSTRATE</span><span class=w> </span>relation|-script<span class=w> </span><span class=o>&lt;</span>nom_script&gt;<span class=w></span>
</code></pre></div> <p><strong>Exemple :</strong> (source <a href=http://pig.apache.org>http://pig.apache.org</a>)</p> <p><div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span><span class=k>cat</span><span class=w> </span>visits.txt<span class=w></span>
Amy<span class=w>     </span>yahoo.com<span class=w>       </span><span class=mi>19990421</span><span class=w></span>
Fred<span class=w>    </span>harvard.edu<span class=w>     </span><span class=mi>19991104</span><span class=w></span>
Amy<span class=w>     </span>cnn.com<span class=w> </span><span class=mi>20070218</span><span class=w></span>
Frank<span class=w>   </span>nba.com<span class=w> </span><span class=mi>20070305</span><span class=w></span>
Fred<span class=w>    </span>berkeley.edu<span class=w>    </span><span class=mi>20071204</span><span class=w></span>
Fred<span class=w>    </span>stanford.edu<span class=w>    </span><span class=mi>20071206</span><span class=w></span>

grunt&gt;<span class=w> </span><span class=k>cat</span><span class=w> </span>visits.pig<span class=w></span>
visits<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>LOAD</span><span class=w> </span><span class=s>&#39;visits.txt&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>user,<span class=w> </span>url,<span class=w> </span>timestamp<span class=p>);</span><span class=w></span>
recent_visits<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FILTER</span><span class=w> </span>visits<span class=w> </span><span class=k>BY</span><span class=w> </span>timestamp<span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s>&#39;20071201&#39;</span><span class=p>;</span><span class=w></span>
historical_visits<span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FILTER</span><span class=w> </span>visits<span class=w> </span><span class=k>BY</span><span class=w> </span>timestamp<span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s>&#39;20000101&#39;</span><span class=p>;</span><span class=w></span>
<span class=k>DUMP</span><span class=w> </span>recent_visits;<span class=w></span>
<span class=k>DUMP</span><span class=w> </span>historical_visits;<span class=w></span>
<span class=k>STORE</span><span class=w> </span>recent_visits<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;recent&#39;</span><span class=p>;</span><span class=w></span>
<span class=k>STORE</span><span class=w> </span>historical_visits<span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=s>&#39;historical&#39;</span><span class=p>;</span><span class=w></span>

grunt&gt;<span class=w> </span>exec<span class=w> </span>visits.pig<span class=w></span>

<span class=p>(</span>Fred,berkeley.edu,20071204<span class=p>)</span><span class=w></span>
<span class=p>(</span>Fred,stanford.edu,20071206<span class=p>)</span><span class=w></span>

<span class=p>(</span>Amy,yahoo.com,19990421<span class=p>)</span><span class=w></span>
<span class=p>(</span>Fred,harvard.edu,19991104<span class=p>)</span><span class=w></span>


grunt&gt;<span class=w> </span><span class=k>illustrate</span><span class=w> </span><span class=o>-</span>script<span class=w> </span>visits.pig<span class=w></span>

<span class=c>------------------------------------------------------------------------</span><span class=w></span>
|<span class=w> </span>visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w></span>
<span class=c>------------------------------------------------------------------------</span><span class=w></span>
|<span class=w>            </span>|<span class=w> </span>Amy<span class=w>             </span>|<span class=w> </span>yahoo.com<span class=w>      </span>|<span class=w> </span><span class=mi>19990421</span><span class=w>             </span>|<span class=w></span>
|<span class=w>            </span>|<span class=w> </span>Fred<span class=w>            </span>|<span class=w> </span>stanford.edu<span class=w>   </span>|<span class=w> </span><span class=mi>20071206</span><span class=w>             </span>|<span class=w></span>
<span class=c>------------------------------------------------------------------------</span><span class=w></span>
<span class=c>-------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w> </span>recent_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w></span>
<span class=c>-------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w>                   </span>|<span class=w> </span>Fred<span class=w>            </span>|<span class=w> </span>stanford.edu<span class=w>   </span>|<span class=w> </span><span class=mi>20071206</span><span class=w>             </span>|<span class=w></span>
<span class=c>-------------------------------------------------------------------------------</span><span class=w></span>
<span class=c>---------------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w> </span><span class=k>Store</span><span class=w> </span>:<span class=w> </span>recent_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w></span>
<span class=c>---------------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w>                           </span>|<span class=w> </span>Fred<span class=w>            </span>|<span class=w> </span>stanford.edu<span class=w>   </span>|<span class=w> </span><span class=mi>20071206</span><span class=w>             </span>|<span class=w></span>
<span class=c>---------------------------------------------------------------------------------------</span><span class=w></span>
<span class=c>-----------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w> </span>historical_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w></span>
<span class=c>-----------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w>                       </span>|<span class=w> </span>Amy<span class=w>             </span>|<span class=w> </span>yahoo.com<span class=w>      </span>|<span class=w> </span><span class=mi>19990421</span><span class=w>             </span>|<span class=w></span>
<span class=c>-----------------------------------------------------------------------------------</span><span class=w></span>
<span class=c>-------------------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w> </span><span class=k>Store</span><span class=w> </span>:<span class=w> </span>historical_visits<span class=w>     </span>|<span class=w> </span>user:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>url:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w> </span>timestamp:<span class=w> </span><span class=kt>bytearray</span><span class=w> </span>|<span class=w></span>
<span class=c>-------------------------------------------------------------------------------------------</span><span class=w></span>
|<span class=w>                               </span>|<span class=w> </span>Amy<span class=w>             </span>|<span class=w> </span>yahoo.com<span class=w>      </span>|<span class=w> </span><span class=mi>19990421</span><span class=w>             </span>|<span class=w></span>
<span class=c>-------------------------------------------------------------------------------------------</span><span class=w></span>
</code></pre></div> <strong>EXPLAIN</strong></p> <p>Affiche les plans d'exécution logique, physique et les phases MapReduce.</p> <div class=highlight><pre><span></span><code><span class=k>EXPLAIN</span><span class=w> </span>relation|-script<span class=w> </span><span class=o>&lt;</span>nom_script&gt;<span class=w> </span><span class=p>[</span><span class=o>-</span>out<span class=w> </span>chemin]<span class=w> </span><span class=p>[</span><span class=o>-</span>dot|-xml]<span class=w></span>
</code></pre></div> <p><strong>Exemple</strong></p> <div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span><span class=k>EXPLAIN</span><span class=w> </span><span class=o>-</span>script<span class=w> </span>wordcount.pig<span class=w> </span><span class=o>-</span>out<span class=w> </span>explain_wordcount.txt<span class=w></span>
</code></pre></div> <p>Le fichier <code>explain_wordcount.txt</code> obtenu contient :</p> <div class=highlight><pre><span></span><code><span class=c1>#-----------------------------------------------</span>
<span class=c1># New Logical Plan:</span>
<span class=c1>#-----------------------------------------------</span>
ordered_word_count: <span class=o>(</span>Name: LOStore Schema: count#112:long,group#109:chararray<span class=o>)</span>
<span class=p>|</span>
<span class=p>|</span>---ordered_word_count: <span class=o>(</span>Name: LOSort Schema: count#112:long,group#109:chararray<span class=o>)</span>
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   count:<span class=o>(</span>Name: Project Type: long Uid: <span class=m>112</span> Input: <span class=m>0</span> Column: <span class=m>0</span><span class=o>)</span>
    <span class=p>|</span>
    <span class=p>|</span>---word_count: <span class=o>(</span>Name: LOForEach Schema: count#112:long,group#109:chararray<span class=o>)</span>
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   <span class=o>(</span>Name: LOGenerate<span class=o>[</span>false,false<span class=o>]</span> Schema: count#112:long,group#109:chararray<span class=o>)</span>ColumnPrune:OutputUids<span class=o>=[</span><span class=m>112</span>, <span class=m>109</span><span class=o>]</span>ColumnPrune:InputUids<span class=o>=[</span><span class=m>109</span>, <span class=m>110</span><span class=o>]</span>
        <span class=p>|</span>   <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   <span class=p>|</span>   <span class=o>(</span>Name: UserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=o>)</span> Type: long Uid: <span class=m>112</span><span class=o>)</span>
        <span class=p>|</span>   <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   <span class=p>|</span>   <span class=p>|</span>---words:<span class=o>(</span>Name: Project Type: bag Uid: <span class=m>110</span> Input: <span class=m>0</span> Column: <span class=o>(</span>*<span class=o>))</span>
        <span class=p>|</span>   <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   <span class=p>|</span>   group:<span class=o>(</span>Name: Project Type: chararray Uid: <span class=m>109</span> Input: <span class=m>1</span> Column: <span class=o>(</span>*<span class=o>))</span>
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   <span class=p>|</span>---words: <span class=o>(</span>Name: LOInnerLoad<span class=o>[</span><span class=m>1</span><span class=o>]</span> Schema: word#109:chararray<span class=o>)</span>
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   <span class=p>|</span>---<span class=o>(</span>Name: LOInnerLoad<span class=o>[</span><span class=m>0</span><span class=o>]</span> Schema: group#109:chararray<span class=o>)</span>
        <span class=p>|</span>
        <span class=p>|</span>---word_groups: <span class=o>(</span>Name: LOCogroup Schema: group#109:chararray,words#110:bag<span class=o>{</span><span class=c1>#114:tuple(word#109:chararray)})</span>
            <span class=p>|</span>   <span class=p>|</span>
            <span class=p>|</span>   word:<span class=o>(</span>Name: Project Type: chararray Uid: <span class=m>109</span> Input: <span class=m>0</span> Column: <span class=m>0</span><span class=o>)</span>
            <span class=p>|</span>
            <span class=p>|</span>---words: <span class=o>(</span>Name: LOForEach Schema: word#118:chararray<span class=o>)</span>
                <span class=p>|</span>   <span class=p>|</span>
                <span class=p>|</span>   <span class=o>(</span>Name: LOGenerate<span class=o>[</span>true<span class=o>]</span> Schema: word#118:chararray<span class=o>)</span>
                <span class=p>|</span>   <span class=p>|</span>   <span class=p>|</span>
                <span class=p>|</span>   <span class=p>|</span>   <span class=o>(</span>Name: UserFunc<span class=o>(</span>org.apache.pig.builtin.TOKENIZE<span class=o>)</span> Type: bag Uid: <span class=m>116</span><span class=o>)</span>
                <span class=p>|</span>   <span class=p>|</span>   <span class=p>|</span>
                <span class=p>|</span>   <span class=p>|</span>   <span class=p>|</span>---<span class=o>(</span>Name: Cast Type: chararray Uid: <span class=m>98</span><span class=o>)</span>
                <span class=p>|</span>   <span class=p>|</span>       <span class=p>|</span>
                <span class=p>|</span>   <span class=p>|</span>       <span class=p>|</span>---line:<span class=o>(</span>Name: Project Type: bytearray Uid: <span class=m>98</span> Input: <span class=m>0</span> Column: <span class=o>(</span>*<span class=o>))</span>
                <span class=p>|</span>   <span class=p>|</span>
                <span class=p>|</span>   <span class=p>|</span>---<span class=o>(</span>Name: LOInnerLoad<span class=o>[</span><span class=m>0</span><span class=o>]</span> Schema: line#98:bytearray<span class=o>)</span>
                <span class=p>|</span>
                <span class=p>|</span>---lines: <span class=o>(</span>Name: LOLoad Schema: line#98:bytearray<span class=o>)</span>RequiredFields:null
<span class=c1>#-----------------------------------------------</span>
<span class=c1># Physical Plan:</span>
<span class=c1>#-----------------------------------------------</span>
ordered_word_count: Store<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/word_count_result:org.apache.pig.builtin.PigStorage<span class=o>)</span> - scope-18
<span class=p>|</span>
<span class=p>|</span>---ordered_word_count: POSort<span class=o>[</span>bag<span class=o>]()</span> - scope-17
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   Project<span class=o>[</span>long<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-16
    <span class=p>|</span>
    <span class=p>|</span>---word_count: New For Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span> - scope-15
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=o>)[</span>long<span class=o>]</span> - scope-11
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   <span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span> - scope-10
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-13
        <span class=p>|</span>
        <span class=p>|</span>---word_groups: Package<span class=o>(</span>Packager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span> - scope-7
            <span class=p>|</span>
            <span class=p>|</span>---word_groups: Global Rearrange<span class=o>[</span>tuple<span class=o>]</span> - scope-6
                <span class=p>|</span>
                <span class=p>|</span>---word_groups: Local Rearrange<span class=o>[</span>tuple<span class=o>]{</span>chararray<span class=o>}(</span><span class=nb>false</span><span class=o>)</span> - scope-8
                    <span class=p>|</span>   <span class=p>|</span>
                    <span class=p>|</span>   Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-9
                    <span class=p>|</span>
                    <span class=p>|</span>---words: New For Each<span class=o>(</span><span class=nb>true</span><span class=o>)[</span>bag<span class=o>]</span> - scope-5
                        <span class=p>|</span>   <span class=p>|</span>
                        <span class=p>|</span>   POUserFunc<span class=o>(</span>org.apache.pig.builtin.TOKENIZE<span class=o>)[</span>bag<span class=o>]</span> - scope-3
                        <span class=p>|</span>   <span class=p>|</span>
                        <span class=p>|</span>   <span class=p>|</span>---Cast<span class=o>[</span>chararray<span class=o>]</span> - scope-2
                        <span class=p>|</span>       <span class=p>|</span>
                        <span class=p>|</span>       <span class=p>|</span>---Project<span class=o>[</span>bytearray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-1
                        <span class=p>|</span>
                        <span class=p>|</span>---lines: Load<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/shakespeare.txt:org.apache.pig.builtin.PigStorage<span class=o>)</span> - scope-0

<span class=c1>#--------------------------------------------------</span>
<span class=c1># Map Reduce Plan                                  </span>
<span class=c1>#--------------------------------------------------</span>
MapReduce node scope-19
Map Plan
word_groups: Local Rearrange<span class=o>[</span>tuple<span class=o>]{</span>chararray<span class=o>}(</span><span class=nb>false</span><span class=o>)</span> - scope-53
<span class=p>|</span>   <span class=p>|</span>
<span class=p>|</span>   Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-55
<span class=p>|</span>
<span class=p>|</span>---word_count: New For Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span> - scope-42
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-43
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=nv>$Initial</span><span class=o>)[</span>tuple<span class=o>]</span> - scope-44
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   <span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span> - scope-45
    <span class=p>|</span>
    <span class=p>|</span>---Pre Combiner Local Rearrange<span class=o>[</span>tuple<span class=o>]{</span>Unknown<span class=o>}</span> - scope-56
        <span class=p>|</span>
        <span class=p>|</span>---words: New For Each<span class=o>(</span><span class=nb>true</span><span class=o>)[</span>bag<span class=o>]</span> - scope-5
            <span class=p>|</span>   <span class=p>|</span>
            <span class=p>|</span>   POUserFunc<span class=o>(</span>org.apache.pig.builtin.TOKENIZE<span class=o>)[</span>bag<span class=o>]</span> - scope-3
            <span class=p>|</span>   <span class=p>|</span>
            <span class=p>|</span>   <span class=p>|</span>---Cast<span class=o>[</span>chararray<span class=o>]</span> - scope-2
            <span class=p>|</span>       <span class=p>|</span>
            <span class=p>|</span>       <span class=p>|</span>---Project<span class=o>[</span>bytearray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-1
            <span class=p>|</span>
            <span class=p>|</span>---lines: Load<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/shakespeare.txt:org.apache.pig.builtin.PigStorage<span class=o>)</span> - scope-0--------
Combine Plan
word_groups: Local Rearrange<span class=o>[</span>tuple<span class=o>]{</span>chararray<span class=o>}(</span><span class=nb>false</span><span class=o>)</span> - scope-57
<span class=p>|</span>   <span class=p>|</span>
<span class=p>|</span>   Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-59
<span class=p>|</span>
<span class=p>|</span>---word_count: New For Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span> - scope-46
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-47
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=nv>$Intermediate</span><span class=o>)[</span>tuple<span class=o>]</span> - scope-48
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   <span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span> - scope-49
    <span class=p>|</span>
    <span class=p>|</span>---word_groups: Package<span class=o>(</span>CombinerPackager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span> - scope-52--------
Reduce Plan
Store<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp-1292167423:org.apache.pig.impl.io.InterStorage<span class=o>)</span> - scope-20
<span class=p>|</span>
<span class=p>|</span>---word_count: New For Each<span class=o>(</span>false,false<span class=o>)[</span>bag<span class=o>]</span> - scope-15
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   POUserFunc<span class=o>(</span>org.apache.pig.builtin.COUNT<span class=nv>$Final</span><span class=o>)[</span>long<span class=o>]</span> - scope-11
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   <span class=p>|</span>---Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span> - scope-50
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   Project<span class=o>[</span>chararray<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-13
    <span class=p>|</span>
    <span class=p>|</span>---word_groups: Package<span class=o>(</span>CombinerPackager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span> - scope-7--------
Global sort: <span class=nb>false</span>
----------------

MapReduce node scope-22
Map Plan
ordered_word_count: Local Rearrange<span class=o>[</span>tuple<span class=o>]{</span>tuple<span class=o>}(</span><span class=nb>false</span><span class=o>)</span> - scope-26
<span class=p>|</span>   <span class=p>|</span>
<span class=p>|</span>   Constant<span class=o>(</span>all<span class=o>)</span> - scope-25
<span class=p>|</span>
<span class=p>|</span>---New For Each<span class=o>(</span><span class=nb>false</span><span class=o>)[</span>tuple<span class=o>]</span> - scope-24
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   Project<span class=o>[</span>long<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-23
    <span class=p>|</span>
    <span class=p>|</span>---Load<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp-1292167423:org.apache.pig.impl.builtin.RandomSampleLoader<span class=o>(</span><span class=s1>&#39;org.apache.pig.impl.io.InterStorage&#39;</span>,<span class=s1>&#39;100&#39;</span><span class=o>))</span> - scope-21--------
Reduce Plan
Store<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp569443691:org.apache.pig.impl.io.InterStorage<span class=o>)</span> - scope-35
<span class=p>|</span>
<span class=p>|</span>---New For Each<span class=o>(</span><span class=nb>false</span><span class=o>)[</span>tuple<span class=o>]</span> - scope-34
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   POUserFunc<span class=o>(</span>org.apache.pig.impl.builtin.FindQuantiles<span class=o>)[</span>tuple<span class=o>]</span> - scope-33
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   <span class=p>|</span>---Project<span class=o>[</span>tuple<span class=o>][</span>*<span class=o>]</span> - scope-32
    <span class=p>|</span>
    <span class=p>|</span>---New For Each<span class=o>(</span>false,false<span class=o>)[</span>tuple<span class=o>]</span> - scope-31
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   Constant<span class=o>(</span>-1<span class=o>)</span> - scope-30
        <span class=p>|</span>   <span class=p>|</span>
        <span class=p>|</span>   Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span> - scope-28
        <span class=p>|</span>
        <span class=p>|</span>---Package<span class=o>(</span>Packager<span class=o>)[</span>tuple<span class=o>]{</span>chararray<span class=o>}</span> - scope-27--------
Global sort: <span class=nb>false</span>
Secondary sort: <span class=nb>true</span>
----------------

MapReduce node scope-37
Map Plan
ordered_word_count: Local Rearrange<span class=o>[</span>tuple<span class=o>]{</span>long<span class=o>}(</span><span class=nb>false</span><span class=o>)</span> - scope-38
<span class=p>|</span>   <span class=p>|</span>
<span class=p>|</span>   Project<span class=o>[</span>long<span class=o>][</span><span class=m>0</span><span class=o>]</span> - scope-16
<span class=p>|</span>
<span class=p>|</span>---Load<span class=o>(</span>hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp-1292167423:org.apache.pig.impl.io.InterStorage<span class=o>)</span> - scope-36--------
Reduce Plan
ordered_word_count: Store<span class=o>(</span>hdfs://master.cluster.virt:8020/user/uti/word_count_result:org.apache.pig.builtin.PigStorage<span class=o>)</span> - scope-18
<span class=p>|</span>
<span class=p>|</span>---New For Each<span class=o>(</span><span class=nb>true</span><span class=o>)[</span>tuple<span class=o>]</span> - scope-41
    <span class=p>|</span>   <span class=p>|</span>
    <span class=p>|</span>   Project<span class=o>[</span>bag<span class=o>][</span><span class=m>1</span><span class=o>]</span> - scope-40
    <span class=p>|</span>
    <span class=p>|</span>---Package<span class=o>(</span>LitePackager<span class=o>)[</span>tuple<span class=o>]{</span>long<span class=o>}</span> - scope-39--------
Global sort: <span class=nb>true</span>
Quantile file: hdfs://master.cluster.virt:8020/tmp/temp-483208883/tmp569443691
----------------
</code></pre></div> <p>Pour avoir un graphe d'exécution :</p> <div class=highlight><pre><span></span><code>grunt&gt;<span class=w> </span><span class=k>EXPLAIN</span><span class=w> </span><span class=o>-</span>script<span class=w> </span>wordcount.pig<span class=w> </span><span class=o>-</span>out<span class=w> </span>explain_wordcount.dot<span class=w> </span><span class=o>-</span>dot<span class=w></span>
</code></pre></div> <p>Puis convertir le fichier .dot en png :</p> <div class=highlight><pre><span></span><code>apt install graphviz -y
dot -Tpng -out explain_wordcount.png explain_wordcount.dot
</code></pre></div> <p>Ce qui donne :</p> <p><img src=assets/images/pig/explain_wordcount.png width=70%></p> <h2 id=references_pig_latin>Références Pig Latin<a class=headerlink href=#references_pig_latin title="Permanent link">&para;</a></h2> <p>Pour une référence complète du langage Pig Latin, aller sur la page de documentation (<a href=https://pig.apache.org/docs/r0.14.0/index.html title="Documentation Pig">ici</a>)</p> <p>Voici aussi, un mémo du langage :</p> <p><a href=assets/Pig-memo.pdf class="image fit" target=_blank><i class="fas fa-file-pdf"></i>Ouvrir dans un nouvel onglet</a></p> <object data=assets/Pig-memo.pdf type=application/pdf width=100% height=700> <embed src=assets/Pig-memo.pdf type=application/pdf> </object> <!--
## Exercice :computer:

### Datasets

- [airports.csv :fontawesome-solid-download:{.heart}](https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/HG7NV7/XTPZZY) : Les aéorports décrits par les champs :
    - 
<div class="highlight"><pre><span></span><code>1   iata    IATA airport code
2   airport Airport name
3   city    Airport city
4   state   USA state
5   country Airport country
6   lat     latitude
7   long    longitude
</code></pre></div>
- [2008.csv.bz2 :fontawesome-solid-download:{.heart}](https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/HG7NV7/EIR0RA) : Le détail des vols de l'année 2008 avec la structure suivante :
    - 
<div class="highlight"><pre><span></span><code>1    Year               1987-2008
2    Month              1-12
3    DayofMonth         1-31
4    DayOfWeek          1 (Monday) - 7 (Sunday)
5    DepTime            actual departure time (local, hhmm)
6    CRSDepTime         scheduled departure time (local, hhmm)
7    ArrTime            actual arrival time (local, hhmm)
8    CRSArrTime         scheduled arrival time (local, hhmm)
9    UniqueCarrier      unique carrier code
10   FlightNum          flight number
11   TailNum            plane tail number
12   ActualElapsedTime  in minutes
13   CRSElapsedTime     in minutes
14   AirTime            in minutes
15   ArrDelay           arrival delay, in minutes
16   DepDelay           departure delay, in minutes
17   Origin             origin IATA airport code
18   Dest               destination IATA airport code
19   Distance           in miles
20   TaxiIn             taxi in time, in minutes
21   TaxiOut            taxi out time in minutes
22   Cancelled          was the flight cancelled?
23   CancellationCode   reason for cancellation (A = carrier, B = weather, C = NAS, D = security)
24   Diverted           1 = yes, 0 = no
25   CarrierDelay       in minutes
26   WeatherDelay       in minutes
27   NASDelay           in minutes
28   SecurityDelay      in minutes
29   LateAircraftDelay  in minutes
</code></pre></div>

### Travail à faire

Après avoir chargé les fichiers dans HDFS, répondre aux questions suivantes avec un script Pig Latin pour chaque question :

1. Quels sont les lignes (source-destination) ayant des temps de vols de plus de 7 heures.
1. Quels sont les pays destination des vols retardés pour des raisons climatiques.
1. Quelle est la cause de l'annulation du plus grand nombre de vols.
1. Le Top 20 des aéoroports selon le nombre total des vols. Calculer pour chaque code d'aéropot de vols entrant et sortant par jour et par mois. 
1. Calculer la proportion des vols retardés (Un vol est considéré retardé si le délai est plus grand que 15mn).
1. Calculer la proportions des vols retardés par campagnie (carrier).
1. Quelles sont les lignes les plus sollicitées.
--> <h2 id=exercice>Exercice <img alt=💻 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f4bb.svg title=:computer:><a class=headerlink href=#exercice title="Permanent link">&para;</a></h2> <h3 id=datasets>Datasets<a class=headerlink href=#datasets title="Permanent link">&para;</a></h3> <p>Ci-après la description des données sur les crédits offerts par une banque à ses clients. (source : <a href=https://www.kaggle.com>https://www.kaggle.com</a> <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 320 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"/></svg></span>) Le fichier <a href=assets/credit_risk_dataset.csv>credit_risk_dataset.csv <span class="twemoji heart"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"/></svg></span></a> est structuré ainsi :</p> <div class=highlight><pre><span></span><code>person_age :                âge du client
person_income :             revenu annuel du client
person_home_ownership :     propriété de la maison : OWN, RENT, MORTGAGE
person_emp_length :         durée en mois du crédit
loan_intent :               motif du crédit (MEDICAL, EDUCATION, PERSONAL, ...)
loan_grade :                A, B, C, D
loan_amnt :                 montant du crédit
loan_int_rate :             taux d&#39;intérêt
loan_status :               état du crédit (1: non remboursé, 0: remboursé)
loan_percent_income :       pourcentage du montant du crédit par rapport au revenu
cb_person_default_on_file : Y/N
cb_person_cred_hist_length :historique (nombre de crédits)
</code></pre></div> <h3 id=travail_a_faire>Travail à faire<a class=headerlink href=#travail_a_faire title="Permanent link">&para;</a></h3> <p>Répondre aux questions suivantes avec Pig.</p> <ol> <li>Calculer le montant total et la durée moyenne des crédits non remboursés.</li> <li>Calculer le porcentage des crédits remboursés et non remboursés.</li> <li>Quelle est la distribution des différents états de propriété de la maison.</li> <li>Quels sont les 3 motifs de crédits les plus demandés.</li> <li>Calculer le porcentage des crédits remboursés et non remboursés par motif puis par grade.</li> </ol> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label="Pied de page"> <a href=mr.html class="md-footer__link md-footer__link--prev" aria-label="Précédent: MapReduce avec Python" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Précédent </span> MapReduce avec Python </div> </div> </a> <a href=hive.html class="md-footer__link md-footer__link--next" aria-label="Suivant: Hive" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Suivant </span> Hive </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - Dr. Hmida Hmida </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://gitlab.com/hhmida target=_blank rel=noopener title=gitlab.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81-2.9-.295-5.7.083-8.4 1.11-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.09 18.09 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3 4.7 0 9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82z"/></svg> </a> <a href=https://github.com/hhmida target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://linkedin.com/in/hhmida target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "content.code.annotate"], "search": "assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.config.lang": "fr", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Rechercher", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version.title": "S\u00e9lectionner la version"}}</script> <script src=assets/javascripts/bundle.2ab50757.min.js></script> </body> </html>